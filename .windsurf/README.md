> **📍 文件位置说明**
> 
> **为什么此文件在 .windsurf/ 而不是 .windsurf/rules/ 目录？**
> 
> - ✅ **此文件是说明文档**，不是规则文件
> - ✅ **Windsurf会扫描** .windsurf/rules/ 目录下所有 .md 文件作为规则
> - ✅ **放在上级目录** 可避免被误识别为规则
> - ✅ **保持独立性** - 文档和规则分离，职责清晰
> 
> **如果放在 
ules/ 目录会发生什么？**
> - ❌ 会出现在 Customizations UI 的规则列表中
> - ❌ 可以通过 @mention 调用（但它不是规则）
> - ❌ 被当作规则处理，造成概念混淆
> 
> ---


# 🎯 Windsurf规则系统完全指南

**版本**: v6.0.0 🚀  
**最后更新**: 2025-11-28  
**规则总数**: 12个（深度强化版）  
**激活模式**: 🔴 全部Always On（自动应用）  
**强化机制**: ✅ 所有规则已添加强制自检清单  
**约束力**: 🔒 从"提醒"升级到"强制思考"  
**通用性**: ✅ 所有规则已通用化，可复用到任何项目  
**文档风格**: 🎨 Emoji增强文档风格（强制）  
**知识库**: 🔒 绝对只读，AI禁止修改  
**命名规范**: 📅 记录类文档=日期在前+时间戳  
**核心理念**: ⚡ AI自律系统，通过自检清单提升约束力  
**目录结构**: .windsurf/rules/



## 📁 目录结构

```
.windsurf/
 README.md                          本文件（规则系统完全指南）
 rules/                             规则文件目录
     00-核心工作原则.md            (Always On) - 🔴 v6.0强化路径检查
     01-文件操作规范.md            (Always On) - 🔴 v6.0添加强制自检
     02-目录管理规范.md            (Always On) - 🔴 v6.0创建前检查
     03-文件命名规范.md            (Always On) - 🔴 v6.0文件名检查
     04-变更同步规则.md            (Always On) - 🔴 v6.0修改后提醒
     05-README管理规范.md          (Always On) - 🔴 v6.0创建后检查
     06-测试组织规范.md            (Always On) - 🔴 v6.0位置检查
     07-Emoji文档风格规范.md       (Always On) - 🔴 v6.0创建时检查
     08-知识库管理规范.md          (Always On) - 🔴 v6.0路径保护
     09-项目结构与配置.md          (Always On) - 🔴 v6.0强制读取内容
     10-Git操作规范.md             (Always On) - 🔴 v6.0执行前自检
     11-命令执行规范.md            (Always On) - 🔴 v6.0调用前自检
```

**激活模式说明**：
- 🔴 **Always On** (12个) - 全部自动应用，无需手动调用

**统计**：
- 总规则数：12个
- 说明文档：1个 (README.md)
- 已删除：7个（损坏/冗余/Git检查）
- 已合并：2个（05+06 → 09）
- 规则编号：00-11（连续编号）

## ✨ 通用化改进（v3.1.0）

**重要变更**：所有规则已完全通用化，不再包含项目特定内容！

### 通用化的规则
1. **06-目录架构模板.md** 
   - ❌ 旧版：包含owlRD项目特定的8个子目录
   - ✅ 新版：提供通用目录结构建议，适用于所有项目类型

2. **09-项目配置.md**
   - ❌ 旧版：包含owlRD项目的具体路径、技术栈、配置
   - ✅ 新版：通用配置指南，教AI如何适应任何项目

### 复用性
✅ **可直接复制到任何新项目**
✅ **AI会观察和适应具体项目**
✅ **不强加固定模式**
✅ **保持灵活性**

---

## 📚 目录

- [规则系统概述](#规则系统概述)
- [激活模式详解](#激活模式详解)
- [规则文件列表](#规则文件列表)
- [Frontmatter格式](#frontmatter格式)
- [文件命名规范](#文件命名规范)
- [使用指南](#使用指南)
- [最佳实践](#最佳实践)
- [常见问题](#常见问题)


## 🎓 规则系统概述

### 什么是Windsurf规则系统？

Windsurf规则系统是一套基于**Markdown + YAML frontmatter**的AI行为规范系统，用于：
- 🔒 强制AI遵守项目规范
- 📋 提供项目特定配置
- 📖 存储参考文档和指南
- 🤖 自动化项目管理

### 工作原理

```
规则文件（.md）
    ↓
frontmatter定义激活模式
    ↓
Windsurf自动识别和加载
    ↓
AI根据模式自动应用或等待调用
```

### 核心特性

✅ **自动发现** - Windsurf自动扫描.windsurf/rules/目录  
✅ **Frontmatter管理** - 无需config.json  
✅ **中文支持** - 文件名和内容完全支持中文  
✅ **灵活激活** - 4种激活模式满足不同需求  
✅ **大小限制** - 每个文件≤12,000字符


## 🎛️ 激活模式详解

### 1. Always On（始终开启）🔴

**特点**：
- ✅ 自动应用到所有对话
- ✅ 无需@mention调用
- ❌ **不显示**在Customizations UI列表
- ❌ **不出现**在@mention自动补全

**使用场景**：
- 核心强制规则（不可违反）
- 项目基本规范
- 文件操作限制
- 命名规范

**示例**：
```yaml
title: "核心工作原则"
description: "AI必须遵守的基本规则"
trigger: always
```

**本项目Always On规则（10个）**：
- 00-核心工作原则.md
- 01-文件操作规范.md
- 02-目录管理规范.md
- 03-文件命名规范.md
- 04-Git工作流规范.md
- 05-变更同步规则.md
- 05-测试组织规范.md
- 07-严格目录控制.md
- 08-规则自我执行.md
- 14-规则文件命名规范.md


### 2. Model Decision（模型决策）🟡

**特点**：
- 🤖 AI根据上下文自动判断是否应用
- ✅ 显示在Customizations UI
- ✅ 可以通过@mention手动调用
- 🎯 智能化应用

**使用场景**：
- 项目特定配置（仅相关时应用）
- 架构模板（创建目录时应用）
- 可选的参考规范

**示例**：
```yaml
title: "项目配置"
description: "项目特定规则和配置"
trigger: model_decision
```

**本项目Model Decision规则（2个）**：
- 06-目录架构模板.md
- 09-项目配置.md


### 3. Manual（手动调用）📖

**特点**：
- ✅ 显示在Customizations UI
- ✅ 出现在@mention自动补全
- ❌ 不自动应用
- 👤 完全由用户控制

**使用场景**：
- 参考文档
- 使用指南
- 移植说明
- 配置示例

**示例**：
```yaml
title: "架构使用指南"
description: "架构模板的使用说明"
trigger: manual
```

**调用方式**：
```
@10-架构使用指南 如何创建新的功能模块？
```

**本项目Manual规则（5个）**：
- 10-架构使用指南.md
- 11-规则同步说明.md
- 12-迁移检查清单.md
- 13-项目配置示例.md
- README.md


### 4. Glob（文件模式匹配）🔍

**特点**：
- 📁 基于文件路径模式自动应用
- 🎯 只在特定文件类型时激活
- ⚡ 高度针对性

**使用场景**：
- 针对特定文件类型的规则（如*.test.ts）
- 目录特定规范（如docs/）

**示例**：
```yaml
title: "测试文件规范"
description: "测试文件的编写规范"
trigger: "**/*.test.ts"
```

**本项目暂无Glob规则**


## 📋 规则文件列表

### 🔴 所有规则（Always On）- 10个

| 编号 | 文件名 | 说明 | 优先级 | 备注 |
|------|--------|------|--------|------|
| 00 | 核心工作原则.md | AI基本工作原则+自检机制+禁止过度文档化 | 🔴 最高 | ✨ v5.1.1新增 |
| 01 | 文件操作规范.md | 文件创建/修改/删除/归属判断 | 🔴 高 | ✨ v1.1增强 |
| 02 | 目录管理规范.md | 目录结构+.windsurf/严格控制 | 🔴 高 | ✨ v5.1.1增强 |
| 03 | 文件命名规范.md | 文件命名标准+时间戳规范 | 🔴 高 | ✨ v4.3增强 |
| 04 | 变更同步规则.md | 修改后同步文档和索引 | 🔴 高 | |
| 05 | README管理规范.md | README.md维护规范 | 🔴 高 | |
| 06 | 测试组织规范.md | 测试文件组织规范 | 🔴 高 | ✅ 已修复转义 |
| 07 | Emoji文档风格规范.md | 强制Emoji增强文档风格 | 🔴 高 | 🎨 新增v4.1 |
| 08 | 知识库管理规范.md | 知识库绝对只读规则 | 🔴 高 | 🔒 新增v4.2 |
| 09 | 项目结构与配置.md | 100%通用项目模板 | 🔴 高 | ✨ v2.3通用化 |
| 10 | Git操作规范.md | Git操作+同步检查流程 | 🔴 高 | ✨ v1.1增强 |


### ❌ 已删除的规则（7个）+ 已合并（2个）

| 编号 | 文件名 | 删除/合并原因 |
|------|--------|---------|
| 04 | Git工作流规范.md | v5.0彻底移除，Windsurf规则已足够 |
| 05 | 目录架构模板.md | v5.1合并到09-项目结构与配置.md |
| 06 | 项目配置.md | v5.1合并到09-项目结构与配置.md |
| 07 | 严格目录控制.md | 文件损坏，功能已合并到02 |
| 08 | 规则自我执行.md | 文件损坏，功能已合并到00 |
| 10 | 架构使用指南.md | 乱码+功能重复（06已足够） |
| 11 | 规则同步说明.md | 乱码+面向多项目（单项目不需要） |
| 12 | 迁移检查清单.md | 乱码+面向多项目（单项目不需要） |
| 14 | 规则文件命名规范.md | 元规则（规则已固定，不需要） |


## 📝 Frontmatter格式

### ⚠️ 重要发现（2025-11-27实测）

**Windsurf的激活模式设置方式**：
- ✅ 通过frontmatter的 `trigger` 字段设置
- ✅ 必须使用正确的值（小写+下划线）
- ❌ `title` 字段**可选**（UI会自动生成）

### 必需字段

```yaml
---
trigger: always_on          # 激活模式（必需）
description: "规则描述"      # 规则说明（必需）
---
```

### 激活模式值对照表

| UI显示 | trigger值 | 额外字段 | 说明 |
|--------|-----------|---------|------|
| **Always On** | `always_on` | - | 自动应用到所有对话 |
| **Manual** | `manual` | - | 需要@mention调用 |
| **Model Decision** | `model_decision` | - | AI智能决策是否应用 |
| **Glob** | `glob` | `globs: *.js` | 基于文件模式匹配 |

### 完整示例

#### Always On规则
```yaml
---
trigger: always_on
description: "文件操作强制规范"
---

# 文件操作规范
规则内容...
```

#### Manual规则
```yaml
---
trigger: manual
description: "架构模板使用指南"
---

# 架构使用指南
参考文档内容...
```

#### Model Decision规则
```yaml
---
trigger: model_decision
description: "项目特定配置规则"
---

# 项目配置
根据上下文智能应用...
```

#### Glob规则
```yaml
---
trigger: glob
description: "JavaScript文件特定规则"
globs: *.js
---

# JavaScript规范
仅应用于.js文件...
```

### 字段说明

| 字段 | 类型 | 必需 | 说明 |
|------|------|------|------|
| `trigger` | string | ✅ | 激活模式：always_on/manual/model_decision/glob |
| `description` | string | ✅ | 规则的中文描述，显示在UI中 |
| `globs` | string | ⚠️ | Glob模式时必需，如 `*.js` 或 `src/**/*.ts` |
| `title` | string | ❌ | 可选，UI会根据文件名生成 |


## 📐 文件命名规范

### 标准格式

```
NN-中文名称.md
```

**格式说明**：
- \NN\ - 两位数字编号（00-99）
- \-\ - 连字符分隔
- \中文名称\ - 清晰的中文描述
- \.md\ - Markdown扩展名

### 编号分配

| 范围 | 用途 | 激活模式 |
|------|------|----------|
| **00-08** | 核心强制规则 | Always On |
| **09** | 项目特定配置 | Model Decision |
| **10-19** | 使用指南和文档 | Manual |
| **20-89** | 预留扩展 | 待定 |
| **90-98** | 临时测试规则 | Manual |
| **99** | 保留（特殊用途） | - |

### 正确示例 ✅

```
00-核心工作原则.md
01-文件操作规范.md
09-项目配置.md
14-规则文件命名规范.md
```

### 错误示例 ❌

```
❌ core-principles.md          # 缺少数字前缀
❌ 00-core-principles.md       # 使用英文而非中文
❌ 1-核心原则.md                # 数字不足两位
❌ 00_核心原则.md               # 使用下划线而非连字符
❌ 00 核心原则.md               # 使用空格而非连字符
```

### 特殊例外

**README.md** - 唯一不需要数字前缀的文件


## 🚀 使用指南

### 查看规则系统

1. **打开Windsurf IDE**
2. **点击左侧栏的"Customizations"图标** ⚙️
3. **查看Rules标签页**

你会看到：
- 🟡 Model Decision规则（2个）
- 📖 Manual规则（5个）
- ❌ Always On规则不显示（但在后台生效）

### 调用Manual规则

**方法1：通过@mention**
```
@10-架构使用指南 如何创建新模块？
```

**方法2：通过UI点击**
- 在Customizations面板点击规则名称
- 规则内容会加载到对话上下文

### 编辑规则

1. **直接编辑文件**：
   ```
   .windsurf/rules/NN-规则名称.md
   ```

2. **修改frontmatter**（如果需要改变激活模式）

3. **保存后立即生效**（无需重启Windsurf）

### 添加新规则

1. **创建新文件**：
   ```
   .windsurf/rules/15-新规则名称.md
   ```

2. **添加frontmatter**：
   ```yaml
   ---
   title: "New Rule Title"
   description: "新规则描述"
   trigger: manual  # 或 always/model_decision
   ---
   ```

3. **编写规则内容**

4. **保存** - Windsurf自动识别


## 💡 最佳实践

### 1. 规则设计原则

✅ **清晰具体** - 规则应该明确、可执行  
✅ **适度使用Always On** - 只用于必须遵守的核心规则  
✅ **分层管理** - 核心规则(00-08) → 项目配置(09) → 参考文档(10+)  
✅ **控制大小** - 每个文件≤12,000字符  

### 2. 激活模式选择

| 情况 | 推荐模式 |
|------|----------|
| 不可违反的核心规范 | Always On |
| 项目特定配置 | Model Decision |
| 使用指南/文档 | Manual |
| 特定文件类型规则 | Glob |

### 3. 命名技巧

- 使用清晰的中文名称（2-6个汉字）
- 避免模糊名称（如"规则1"、"新规则"）
- 使用标准术语（规范、指南、清单）

### 4. 维护建议

📅 **定期检查** - 确保规则仍然适用  
📝 **及时更新** - 项目变化时同步规则  
🧹 **清理过时规则** - 删除不再需要的规则  
📊 **验证生效** - 测试规则是否按预期工作  


## ❓ 常见问题

### Q1: Always On规则为什么不显示在UI中？

**A**: 这是Windsurf的设计。Always On规则自动应用到所有对话，无需用户手动调用，因此不需要在UI中显示。

### Q2: 如何验证Always On规则是否生效？

**A**: 尝试违反规则，看AI是否会拒绝或警告。例如：
```
"在项目根目录创建test.md文件"
```
如果AI拒绝并说明违反了规则，说明规则生效。

### Q3: 中文文件名会有问题吗？

**A**: 完全支持！Windsurf可以正常识别中文文件名。推荐使用中文名称以提高可读性。

### Q4: 规则文件可以超过12,000字符吗？

**A**: 不建议。超过限制可能导致：
- 规则无法完全加载
- AI理解困难
- 性能问题

如果内容过多，建议拆分为多个规则文件。

### Q5: 修改规则后需要重启Windsurf吗？

**A**: 不需要。保存后Windsurf会自动重新加载规则。

### Q6: 可以在规则中使用Emoji吗？

**A**: 可以！但要注意UTF-8编码。如果出现乱码，检查文件编码是否为UTF-8。

### Q7: Model Decision模式的规则何时会被应用？

**A**: 由AI根据对话上下文智能判断。例如：
- 讨论目录结构时 → 应用06-目录架构模板
- 需要项目配置信息时 → 应用09-项目配置

### Q8: 如何移植规则系统到新项目？

**A**: 参考 @12-迁移检查清单，主要步骤：
1. 复制整个\.windsurf/rules/\目录
2. 修改\ 9-项目配置.md\
3. 删除或修改项目特定规则
4. 验证规则加载


## 📊 规则系统统计

```
总规则数：      17个
Always On：     10个 (59%)
Model Decision： 2个 (12%)
Manual：         5个 (29%)
Glob：           0个 (0%)

总字符数：      ~95KB
平均文件大小：  ~5.6KB
最大文件：      01-文件操作规范.md (23KB)
```


## 🎯 快速参考

### 常用命令

```ash
# 查看规则文件列表
ls .windsurf/rules/*.md

# 查找特定规则
grep -r "关键词" .windsurf/rules/

# 检查文件大小
Get-ChildItem .windsurf/rules/*.md | Select Name, Length
```

### 常用@mention

```
@10-架构使用指南     # 架构说明
@11-规则同步说明     # 规则同步流程
@12-迁移检查清单     # 移植到新项目
@13-项目配置示例     # 配置模板
@README              # 本总览文档
```


## 📚 相关资源

- **Windsurf官方文档**: https://docs.windsurf.com
- **规则系统设计**: @11-规则同步说明
- **项目配置**: @09-项目配置
- **迁移指南**: @12-迁移检查清单


## ✅ 版本历史

| 版本 | 日期 | 变更 |
|------|------|------|
| v2.0.0 | 2025-11-27 | 全面更新README，添加完整文档 |
| v1.6.0 | 2025-11-26 | 精简.windsurf目录，删除scripts和config.json |
| v1.5.0 | 2025-11-26 | 规则文件全面中文化 |
| v1.0.0 | 2025-11-26 | 从.windsurfrules迁移到.windsurf/rules |


## 📞 帮助与支持

**遇到问题？**
1. 查看本README的常见问题部分
2. 参考相关规则文件的详细说明
3. 检查frontmatter格式是否正确
4. 验证文件编码为UTF-8

**规则系统已完全就绪！祝开发愉快！** 🎉✨