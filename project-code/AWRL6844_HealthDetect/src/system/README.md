# ğŸ› ï¸ System Configuration Directory

> **ç›®å½•ä½œç”¨**: é“¾æ¥è„šæœ¬ + ç³»ç»Ÿæ‰“åŒ…é…ç½®ï¼ˆğŸ”´ å¿…é¡»ï¼‰  
> **åˆ›å»ºæ—¥æœŸ**: 2026-01-07

---

## ğŸ“‹ ç›®å½•å†…å®¹

### é“¾æ¥è„šæœ¬

| æ–‡ä»¶ | ç›®æ ‡æ ¸å¿ƒ | è¯´æ˜ |
|------|---------|------|
| **linker_mss.cmd** | R5F @ 200MHz | MSS/APPSSé“¾æ¥è„šæœ¬ |
| **linker_dss.cmd** | C66x @ 450MHz | DSSé“¾æ¥è„šæœ¬ |
| **shared_memory.ld** | å…±äº«å®šä¹‰ | L3å…±äº«RAMå†…å­˜æ˜ å°„ |

### ğŸ”´ ç³»ç»Ÿæ‰“åŒ…é…ç½®ï¼ˆå¿…é¡»ï¼‰

| æ–‡ä»¶ | ä½œç”¨ | çŠ¶æ€ |
|------|------|------|
| **system.xml** | å¤šæ ¸åè°ƒé…ç½® | âœ… å·²åˆ›å»º |
| **makefile_system_ccs_bootimage_gen** | æ‰“åŒ…è„šæœ¬ | âœ… å·²åˆ›å»º |
| **config/metaimage_cfg.release.json** | Releaseé…ç½® | âœ… å·²åˆ›å»º |
| **config/metaimage_cfg.debug.json** | Debugé…ç½® | âœ… å·²åˆ›å»º |

---

## ğŸ¯ ç³»ç»Ÿæ‰“åŒ…è¯´æ˜

### ä¸ºä»€ä¹ˆéœ€è¦ç³»ç»Ÿæ‰“åŒ…ï¼Ÿ

**ç³»ç»Ÿæ‰“åŒ…æ˜¯å¿…é€‰é¡¹ï¼Œä¸æ˜¯å¯é€‰çš„ï¼**

| åŸå›  | è¯´æ˜ |
|-----|------|
| âœ… ç‰ˆæœ¬ä¸€è‡´æ€§ | ç¡®ä¿MSSå’ŒDSSç‰ˆæœ¬åŒ¹é… |
| âœ… å‘å¸ƒæ ‡å‡† | TIå®˜æ–¹æ¨èçš„å‘å¸ƒæ–¹å¼ |
| âœ… ç”Ÿäº§éƒ¨ç½² | å·¥å‚çƒ§å½•éœ€è¦å•æ–‡ä»¶ |
| âœ… OTAå‡çº§ | æ”¯æŒæ•´ä½“å‡çº§ |
| âœ… å®Œæ•´æ€§éªŒè¯ | Meta Headeræä¾›CRCæ ¡éªŒ |
| âœ… RFå›ºä»¶é›†æˆ | è‡ªåŠ¨åŒ…å«å°„é¢‘å›ºä»¶ |

### ç³»ç»Ÿæ‰“åŒ…æµç¨‹

```
1. Build System Project (åœ¨CCSä¸­)
   â†“
2. è‡ªåŠ¨ç¼–è¯‘MSS â†’ mss.rig
   â†“
3. è‡ªåŠ¨ç¼–è¯‘DSS â†’ dss.rig
   â†“
4. æ‰§è¡Œåå¤„ç†æ­¥éª¤ï¼ˆmakefileï¼‰
   â†“
5. metaImage_creator å·¥å…·
   â†“
6. ç”Ÿæˆ health_detect_system.release.appimage
```

### .appimageæ–‡ä»¶ç»“æ„

```
health_detect_system.release.appimage
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ Meta Header (å…ƒä¿¡æ¯)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ MSS Image (mss.rig)
â”‚  â”œâ”€ MSS.out (ARMä»£ç )
â”‚  â””â”€ Size: ~500KB
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ DSS Image (dss.rig)
â”‚  â”œâ”€ DSS.out (DSPä»£ç )
â”‚  â””â”€ Size: ~200KB
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ RF Firmware Patch
â”‚  â””â”€ mmwave_rfs_patch.rig
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total: ~750KB
```

---

## ğŸ“ linker_mss.cmd - MSSé“¾æ¥è„šæœ¬

### å†…å­˜åŒºåŸŸå®šä¹‰

```
R5Fæœ¬åœ°å†…å­˜ï¼š
- RESET_VECTORS: 0x00000000 (240B)   - å¼‚å¸¸å‘é‡è¡¨
- TCMA_RAM:      0x00000100 (512KB)  - ä»£ç +æ•°æ®
- TCMB_RAM:      0x08009000 (220KB)  - ä»£ç +æ•°æ®

å…±äº«å†…å­˜ï¼š
- IPC_SH_MEM:    0x88000000 (1KB)    - Mailboxé€šä¿¡
- DSS_L3:        0x88000400 (1407KB) - DSS L3 RAM
- L3_SHARED_RAM: 0x51000000 (896KB)  - MSS-DSSå…±äº«æ•°æ®
```

### å…³é”®Section

| Section | ä½ç½® | ç”¨é€” |
|---------|------|------|
| `.vectors` | RESET_VECTORS | å¼‚å¸¸å‘é‡è¡¨ï¼ˆå¿…é¡»åœ¨0x0ï¼‰ |
| `.text` | TCMA/TCMB | ä»£ç æ®µ |
| `.data` | TCMA/TCMB | å·²åˆå§‹åŒ–æ•°æ® |
| `.bss` | TCMA/TCMB | æœªåˆå§‹åŒ–æ•°æ® |
| `.l3_shared_ram` | L3_SHARED_RAM | å¥åº·æ£€æµ‹ç‰¹å¾æ•°æ® |
| `.ipc_sh_mem` | IPC_SH_MEM | IPCé€šä¿¡ç¼“å†² |

### ä½¿ç”¨æ–¹æ³•

**åœ¨MSSä»£ç ä¸­è®¿é—®å…±äº«å†…å­˜**ï¼š

```c
// æ–¹æ³•1: ç›´æ¥è®¿é—®ï¼ˆè¯»å–DSSå†™å…¥çš„æ•°æ®ï¼‰
volatile HealthDetect_PointCloudFeatures_t *pFeatures = 
    (HealthDetect_PointCloudFeatures_t *)0x51003000;  // FEATURE_DATA_BASE

float centerX = pFeatures->centerX;

// æ–¹æ³•2: å£°æ˜å˜é‡åœ¨å…±äº«RAMï¼ˆMSSå†™å…¥ï¼ŒDSSè¯»å–ï¼‰
#pragma DATA_SECTION(gDpcConfig, ".l3_shared_ram")
DPC_Config_t gDpcConfig;
```

---

## ğŸ“ linker_dss.cmd - DSSé“¾æ¥è„šæœ¬

### å†…å­˜åŒºåŸŸå®šä¹‰

```
C66xæœ¬åœ°å†…å­˜ï¼š
- L2_RAM:        0x00800000 (256KB)  - é«˜é€Ÿç¼“å­˜/æ•°æ®

å…±äº«å†…å­˜ï¼š
- L3_RAM:        0x88000400 (1407KB) - DSSå·¥ä½œRAM
- L3_SHARED_RAM: 0x51000000 (896KB)  - MSS-DSSå…±äº«æ•°æ®
```

### å…³é”®Section

| Section | ä½ç½® | ç”¨é€” |
|---------|------|------|
| `.text` | L2_RAM/L3_RAM | DSPä»£ç  |
| `.data` | L2_RAM/L3_RAM | æ•°æ® |
| `.l3_shared_ram` | L3_SHARED_RAM | ç‰¹å¾æ•°æ®ï¼ˆDSSå†™å…¥ï¼‰ |
| `.dpc_config` | L3_SHARED_RAM | DPCé…ç½®ï¼ˆDSSè¯»å–ï¼‰ |
| `.point_cloud` | L3_SHARED_RAM | ç‚¹äº‘æ•°æ®ï¼ˆDSSå†™å…¥ï¼‰ |
| `.feature_data` | L3_SHARED_RAM | ç‰¹å¾æ•°æ®ï¼ˆDSSå†™å…¥ï¼‰ |

### ä½¿ç”¨æ–¹æ³•

**åœ¨DSSä»£ç ä¸­å†™å…¥ç‰¹å¾æ•°æ®**ï¼š

```c
// å£°æ˜ç‰¹å¾æ•°æ®åœ¨å…±äº«RAM
#pragma DATA_SECTION(gFeatureData, ".feature_data")
HealthDetect_PointCloudFeatures_t gFeatureData;

void FeatureExtract_run(const DPIF_PointCloudCartesian *pointCloud, 
                        uint32_t numPoints) {
    // è®¡ç®—è´¨å¿ƒ
    gFeatureData.centerX = computeCenterX(pointCloud, numPoints);
    gFeatureData.centerY = computeCenterY(pointCloud, numPoints);
    
    // MSSä¼šä» 0x51003000 è¯»å–è¿™äº›æ•°æ®
}
```

---

## ğŸ“ shared_memory.ld - å…±äº«RAMæ˜ å°„

### L3 Shared RAMå¸ƒå±€ (896 KB)

```
åŸºåœ°å€: 0x51000000

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 0x51000000 - 0x51001000  (4KB)          â”‚
â”‚ [DPCé…ç½®åŒº]                              â”‚
â”‚ MSSå†™ â†’ DSSè¯»                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x51001000 - 0x51003000  (8KB)          â”‚
â”‚ [ç‚¹äº‘æ•°æ®åŒº]                              â”‚
â”‚ DSSå†™ â†’ MSSè¯»                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x51003000 - 0x51004000  (4KB)          â”‚
â”‚ [ç‰¹å¾æ•°æ®åŒº] ğŸ”¥ å¥åº·æ£€æµ‹æ ¸å¿ƒ             â”‚
â”‚ DSSå†™ â†’ MSSè¯»                            â”‚
â”‚ - centerX/Y/Z, spreadXY/Z               â”‚
â”‚ - avgVelocity, maxVelocity              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x51004000 - 0x51005000  (4KB)          â”‚
â”‚ [DPCç»“æœåŒº]                              â”‚
â”‚ DSSå†™ â†’ MSSè¯»                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x51005000 - 0x510E0000  (876KB)        â”‚
â”‚ [DSSå·¥ä½œç¼“å†²åŒº]                          â”‚
â”‚ DSSå†…éƒ¨ä½¿ç”¨                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸Cå¤´æ–‡ä»¶çš„å¯¹åº”

**shared_memory.ld** å®šä¹‰é“¾æ¥å™¨ç¬¦å·ï¼š
```ld
DPC_CONFIG_BASE   = 0x51000000;
FEATURE_DATA_BASE = 0x51003000;
```

**src/common/shared_memory.h** å®šä¹‰Cå®ï¼š
```c
#define DPC_CONFIG_BASE   0x51000000
#define FEATURE_DATA_BASE 0x51003000
```

**ä¸¤è€…å¿…é¡»ä¿æŒåŒæ­¥ï¼**

---

## ğŸ”„ CCSé¡¹ç›®é…ç½®å¼•ç”¨

### åœ¨projectspecä¸­å¼•ç”¨

**ä¿®æ”¹ `xwrL684x-evm/r5fss0-0_freertos/ti-arm-clang/example.projectspec`**ï¼š

```xml
<!-- åŸæ¥çš„é”™è¯¯å¼•ç”¨ -->
<file path="linker.cmd" ... />  âŒ

<!-- æ­£ç¡®çš„å¼•ç”¨ -->
<file path="../../../src/system/linker_mss.cmd" ... />  âœ…
```

### åœ¨makefileä¸­å¼•ç”¨

**ä¿®æ”¹ `xwrL684x-evm/r5fss0-0_freertos/ti-arm-clang/makefile`**ï¼š

```makefile
# åŸæ¥çš„é”™è¯¯å¼•ç”¨
LNK_FILES_common = linker.cmd  âŒ

# æ­£ç¡®çš„å¼•ç”¨
LNK_FILES_common = ../../../src/system/linker_mss.cmd  âœ…
```

---

## âœ… ä½¿ç”¨æ£€æŸ¥æ¸…å•

### å¼€å‘äººå‘˜æ£€æŸ¥

- [ ] MSSé¡¹ç›®å¼•ç”¨ `src/system/linker_mss.cmd`
- [ ] DSSé¡¹ç›®å¼•ç”¨ `src/system/linker_dss.cmd`
- [ ] `shared_memory.ld` ä¸ `src/common/shared_memory.h` åœ°å€ä¸€è‡´
- [ ] MSSä»£ç ä½¿ç”¨ `#pragma DATA_SECTION` æ”¾ç½®å…±äº«æ•°æ®
- [ ] DSSä»£ç ä½¿ç”¨ `#pragma DATA_SECTION` æ”¾ç½®ç‰¹å¾æ•°æ®

### ç¼–è¯‘éªŒè¯

- [ ] MSSé¡¹ç›®ç¼–è¯‘é€šè¿‡ï¼ˆ0 errorsï¼‰
- [ ] DSSé¡¹ç›®ç¼–è¯‘é€šè¿‡ï¼ˆ0 errorsï¼‰
- [ ] `.map` æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ° `.l3_shared_ram` section
- [ ] å…±äº«RAMåœ°å€æ­£ç¡®åˆ†é…

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **src/common/shared_memory.h** - Cè¯­è¨€å…±äº«å†…å­˜å®šä¹‰
- **src/common/health_detect_types.h** - ç‰¹å¾æ•°æ®ç»“æ„
- **docs/memory_map.md** - è¯¦ç»†å†…å­˜å¸ƒå±€æ–‡æ¡£
- **é™„ä»¶ï¼šç¬¬3ç« æ¶æ„æ¼”è¿›è§„åˆ’** - æ¶æ„è®¾è®¡åŸç†

---

> ğŸ’¡ **é‡è¦æç¤º**ï¼šé“¾æ¥è„šæœ¬æ˜¯ç³»ç»Ÿçº§é…ç½®ï¼Œä¿®æ”¹åå¿…é¡»é‡æ–°ç¼–è¯‘æ•´ä¸ªé¡¹ç›®ï¼

> ğŸ”¥ **æ ¸å¿ƒæ€æƒ³**ï¼šMSSå’ŒDSSé€šè¿‡L3å…±äº«RAMé«˜æ•ˆä¼ é€’æ•°æ®ï¼Œé¿å…æ‹·è´å¼€é”€ã€‚
