# ðŸ”„ è‡ªåŠ¨åŒæ­¥éƒ¨ç½²è„šæœ¬å’Œè¯´æ˜Žä¹¦åˆ°å…¬å¼€ Gist
# 
# è§¦å‘æ¡ä»¶ï¼š
#   1. âœ… è‡ªåŠ¨è§¦å‘ï¼šå½“éƒ¨ç½²è„šæœ¬æˆ–è¯´æ˜Žä¹¦æ–‡ä»¶æ›´æ–°æ—¶ï¼ˆä¸»è¦æ–¹å¼ï¼‰
#   2. âš™ï¸ æ‰‹åŠ¨è§¦å‘ï¼šé€šè¿‡ GitHub Actions é¡µé¢æ‰‹åŠ¨è¿è¡Œï¼ˆå¤‡ç”¨æ–¹å¼ï¼‰
#
# åŠŸèƒ½ï¼šå°†éƒ¨ç½²è„šæœ¬åŒæ­¥åˆ°å…¬å¼€ Gistï¼Œæ–¹ä¾¿ç”¨æˆ·ç›´æŽ¥ä¸‹è½½ä½¿ç”¨
# çŠ¶æ€ï¼šâœ… å¿…é¡»ä¿ç•™ - GIST_TOKEN å’Œ GIST_ID å·²é…ç½®

name: Sync Deploy Files to Gist

on:
  push:
    paths:
      - 'project-code/server/owl-website-docker-deploy.sh'
      - 'project-code/server/wisefidoç½‘ç«™ä¸€é”®DOCKERéƒ¨ç½²ä¸Žè¿ç§»è¯´æ˜Žä¹¦.md'
    branches:
      - main
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘ï¼ˆå¤‡ç”¨ï¼‰

jobs:
  sync-to-gist:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Sync Deploy Script to Gist
        uses: popsiclestick/gist-sync-action@v1.2.0
        with:
          auth: ${{ secrets.GIST_TOKEN }}
          gist_url: https://gist.github.com/${{ secrets.GIST_ID }}
          gist_title: owl-website-docker-deploy.sh
          gist_description: "WiseFido Owl Website Docker éƒ¨ç½²è„šæœ¬ä¸Žè¯´æ˜Žä¹¦ (è‡ªåŠ¨åŒæ­¥è‡ªç§æœ‰ä»“åº“)"
          github_file: project-code/server/owl-website-docker-deploy.sh

      - name: Sync Deploy Doc to Gist
        uses: popsiclestick/gist-sync-action@v1.2.0
        with:
          auth: ${{ secrets.GIST_TOKEN }}
          gist_url: https://gist.github.com/${{ secrets.GIST_ID }}
          gist_title: wisefidoç½‘ç«™ä¸€é”®DOCKERéƒ¨ç½²ä¸Žè¿ç§»è¯´æ˜Žä¹¦.md
          gist_description: "WiseFido Owl Website Docker éƒ¨ç½²è„šæœ¬ä¸Žè¯´æ˜Žä¹¦ (è‡ªåŠ¨åŒæ­¥è‡ªç§æœ‰ä»“åº“)"
          github_file: project-code/server/wisefidoç½‘ç«™ä¸€é”®DOCKERéƒ¨ç½²ä¸Žè¿ç§»è¯´æ˜Žä¹¦.md

      - name: Generate sync summary
        run: |
          echo "## ðŸ”„ éƒ¨ç½²æ–‡ä»¶å·²åŒæ­¥åˆ° Gist" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### å·²åŒæ­¥æ–‡ä»¶" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… \`owl-website-docker-deploy.sh\` - Dockerä¸€é”®éƒ¨ç½²è„šæœ¬" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… \`wisefidoç½‘ç«™ä¸€é”®DOCKERéƒ¨ç½²ä¸Žè¿ç§»è¯´æ˜Žä¹¦.md\` - éƒ¨ç½²è¯´æ˜Žæ–‡æ¡£" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Gist åœ°å€" >> $GITHUB_STEP_SUMMARY
          echo "ç”¨æˆ·å¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤ç›´æŽ¥ä¸‹è½½ï¼š" >> $GITHUB_STEP_SUMMARY
          echo "\`\`\`bash" >> $GITHUB_STEP_SUMMARY
          echo "wget https://gist.githubusercontent.com/${{ github.repository_owner }}/${{ secrets.GIST_ID }}/raw/owl-website-docker-deploy.sh" >> $GITHUB_STEP_SUMMARY
          echo "chmod +x owl-website-docker-deploy.sh" >> $GITHUB_STEP_SUMMARY
          echo "\`\`\`" >> $GITHUB_STEP_SUMMARY


