---
description: "🔴 任务完成验证规则 - 确保AI完成所有任务并验证"
applyTo: "**"
---

# 🔴 任务完成验证规则

**规则类型**: 🔴 强制规则  
**强制级别**: 🔴 严格执行  
**适用范围**: 所有任务处理流程

---

## 🎯 核心原则

### AI在处理任务时必须遵守

**绝对禁止**：
- ❌ 没有完成所有任务就说"完成"
- ❌ 跳过困难的任务
- ❌ 不验证就声称修复完成
- ❌ 遗漏用户列出的任务项

**必须执行**：
- ✅ 明确列出所有任务项
- ✅ 逐个完成并标记状态
- ✅ 完成后进行验证
- ✅ 向用户汇报完成情况

---

## 📋 任务处理流程

### Step 1: 任务识别与记录

当用户提出多个任务时，AI必须：

1. **完整列出所有任务**
   ```markdown
   收到的任务清单：
   1. [任务1描述]
   2. [任务2描述]
   3. [任务3描述]
   ...
   ```

2. **使用 TODO 列表跟踪**
   - 使用 `manage_todo_list` 工具记录所有任务
   - 每个任务必须有明确的描述和状态

3. **确认理解**
   - 如有不明确的任务，主动询问用户

### Step 2: 逐个执行任务

**执行规则**：
- ✅ 一次只处理一个任务
- ✅ 完成一个再开始下一个
- ✅ 遇到困难不跳过，尝试解决或询问
- ✅ 每完成一个任务立即更新 TODO 状态

**禁止行为**：
- ❌ 同时开始多个任务但都不完成
- ❌ 因为困难而跳过某个任务
- ❌ 不更新任务状态

### Step 3: 完成验证

每个任务完成后必须验证：

1. **代码修改验证**
   - 确认文件已保存
   - 检查是否有语法错误
   - 确认修改符合需求

2. **功能验证**
   - 如可能，测试修改后的功能
   - 检查是否引入新问题

3. **文档更新**
   - 如涉及新功能，更新相关文档
   - 如涉及配置变更，记录变更

### Step 4: 完成汇报

所有任务完成后，AI必须提供完成报告：

```markdown
## ✅ 任务完成汇报

### 已完成的任务
1. ✅ [任务1] - [简要说明做了什么]
2. ✅ [任务2] - [简要说明做了什么]
3. ✅ [任务3] - [简要说明做了什么]

### 修改的文件
- `文件路径1` - [修改说明]
- `文件路径2` - [修改说明]

### 需要用户验证
- [ ] [验证项1]
- [ ] [验证项2]
```

---

## 🚫 绝对禁止的行为

### 1. 不完整报告

**❌ 错误示例**：
```
AI: "我已经修复了一些问题，你可以测试一下。"
```

**✅ 正确示例**：
```
AI: "我已完成以下修复：
1. ✅ 修复了登录问题 - 修改了 auth.js 第23行的验证逻辑
2. ✅ 修复了样式问题 - 更新了 styles.css 中的按钮样式
请验证以下功能是否正常工作..."
```

### 2. 遗漏任务

**❌ 错误示例**：
```
用户给了5个任务，AI只完成了3个就说"完成"
```

**✅ 正确做法**：
```
使用 TODO 列表跟踪所有5个任务
逐个完成，状态实时更新
最后验证所有5个任务都已完成
```

### 3. 跳过困难任务

**❌ 错误示例**：
```
AI: "其他任务我完成了，但第3个任务比较复杂，你可能需要自己处理。"
```

**✅ 正确做法**：
```
尝试多种方法解决
如确实无法解决，明确说明尝试过的方法和遇到的具体问题
询问用户是否有额外信息或建议
```

---

## 🔍 自检清单

### 任务开始前

- [ ] 我列出了所有任务吗？
- [ ] 我理解每个任务的要求吗？
- [ ] 我创建了 TODO 列表吗？

### 任务执行中

- [ ] 我当前在处理哪个任务？
- [ ] 我更新了任务状态吗？
- [ ] 我是否跳过了某个任务？

### 任务完成后

- [ ] 所有任务都完成了吗？
- [ ] 我验证了每个修改吗？
- [ ] 我提供了完整的完成报告吗？
- [ ] 我告知用户需要验证什么吗？

---

## 📊 任务状态定义

| 状态 | 含义 | 行动 |
|------|------|------|
| ⏳ not-started | 未开始 | 等待处理 |
| 🔄 in-progress | 进行中 | 当前正在处理 |
| ✅ completed | 已完成 | 已验证完成 |
| ❌ blocked | 被阻塞 | 需要额外信息或帮助 |

---

## 💡 最佳实践

### 1. 复杂任务分解

如果任务很复杂，将其分解为子任务：

```markdown
任务: 重构用户模块
├── 子任务1: 分析现有代码结构
├── 子任务2: 设计新的模块结构
├── 子任务3: 实现新模块
├── 子任务4: 迁移现有功能
└── 子任务5: 测试和验证
```

### 2. 依赖关系处理

如果任务之间有依赖关系，先完成被依赖的任务：

```markdown
任务执行顺序：
1. 任务A（无依赖）
2. 任务B（依赖A）
3. 任务C（依赖A和B）
```

### 3. 持续沟通

- 长时间任务中定期汇报进度
- 遇到问题及时沟通
- 完成重要节点时通知用户

---

## 🎓 案例分析

### 案例1: 多任务处理

**用户请求**：
> 请帮我完成以下任务：
> 1. 修复登录页面的样式问题
> 2. 添加用户头像上传功能
> 3. 优化数据库查询性能

**正确处理流程**：

1. **创建 TODO 列表**
   ```
   - [ ] 任务1: 修复登录页面样式
   - [ ] 任务2: 添加头像上传功能
   - [ ] 任务3: 优化数据库查询
   ```

2. **逐个执行**
   - 处理任务1，完成后标记 ✅
   - 处理任务2，完成后标记 ✅
   - 处理任务3，完成后标记 ✅

3. **最终汇报**
   ```markdown
   ## 任务完成汇报
   
   ✅ 任务1: 修复了登录页面样式
   - 修改: login.css 第45-67行
   - 修复: 按钮对齐问题、输入框间距
   
   ✅ 任务2: 添加了头像上传功能
   - 新增: upload.js (头像上传逻辑)
   - 修改: profile.html (添加上传UI)
   - 修改: server.js (添加上传API)
   
   ✅ 任务3: 优化了数据库查询
   - 修改: queries.js (添加索引、优化JOIN)
   - 预期性能提升: 约40%
   
   请验证以上功能是否正常工作。
   ```

---

> 🔴 **AI必须记住**：**用户给的任务，一个都不能少！**

> 💡 **核心准则**：完整、准确、可验证
