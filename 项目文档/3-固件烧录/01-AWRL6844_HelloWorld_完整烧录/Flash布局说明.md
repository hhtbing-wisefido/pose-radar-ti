# ğŸ“Š AWRL6844 QSPI Flash å¸ƒå±€è¯´æ˜

> **åŸºäº**: TIå®˜æ–¹SDKæ–‡æ¡£å’ŒSBLæºç åˆ†æ

---

## ğŸ—ºï¸ å®Œæ•´å†…å­˜å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            AWRL6844 QSPI Flash å†…å­˜å¸ƒå±€ (2MB)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   åœ°å€èŒƒå›´    â”‚    å¤§å°      â”‚    å†…å®¹     â”‚      è¯´æ˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x00000000   â”‚   256 Bytes  â”‚ Flash Headerâ”‚ ROMåŠ è½½å™¨è¯†åˆ«æ ‡å¿— â”‚
â”‚              â”‚              â”‚             â”‚ (è‡ªåŠ¨ç”Ÿæˆ)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x00000100   â”‚  ~256 KB     â”‚ SBL Boot    â”‚ äºŒçº§å¼•å¯¼ç¨‹åº      â”‚
â”‚              â”‚              â”‚ loader      â”‚ (sbl_meta.bin)    â”‚
â”‚              â”‚              â”‚             â”‚                   â”‚
â”‚ 0x0003FFFF   â”‚              â”‚             â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x00040000   â”‚  ~512 KB     â”‚ Application â”‚ ç”¨æˆ·åº”ç”¨ç¨‹åº      â”‚
â”‚              â”‚              â”‚ Meta Image  â”‚ (hello_world)     â”‚
â”‚              â”‚              â”‚             â”‚                   â”‚
â”‚ 0x000BFFFF   â”‚              â”‚             â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x000C0000   â”‚  ~1.2 MB     â”‚   ä¿ç•™åŒºåŸŸ   â”‚ æœªæ¥æ‰©å±•/OTA     â”‚
â”‚              â”‚              â”‚             â”‚                   â”‚
â”‚ 0x001FFFFF   â”‚              â”‚             â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ å…³é”®åœ°å€å®šä¹‰

### 1. Flash Header (0x00000000)

**ä½ç½®**: Flashèµ·å§‹256å­—èŠ‚  
**ä½œç”¨**: ROM Bootloaderè¯†åˆ«æ ‡å¿—

**ç»“æ„**:
```c
typedef struct {
    uint32_t magic;           // 0x544F4F42 ("BOOT")
    uint32_t imageSize;       // SBLå¤§å°
    uint32_t loadAddress;     // åŠ è½½åœ°å€ï¼ˆRAMï¼‰
    uint32_t entryPoint;      // å…¥å£åœ°å€
    uint32_t checksum;        // æ ¡éªŒå’Œ
    // ... å…¶ä»–å­—æ®µ
} FlashHeader_t;
```

**æ¥æº**: ç”±`metaImage_creator.exe`è‡ªåŠ¨ç”Ÿæˆï¼ŒåµŒå…¥åœ¨SBL Meta Imageä¸­

---

### 2. SBL Bootloader (0x00000100)

**ä½ç½®**: 0x100 - 0x3FFFF  
**å¤§å°**: ~256KB  
**æ–‡ä»¶**: `sbl_meta.bin`

**åŠŸèƒ½**:
- âœ… åˆå§‹åŒ–ç¡¬ä»¶ï¼ˆæ—¶é’Ÿã€DDRã€å¤–è®¾ï¼‰
- âœ… è§£æMeta Imageæ ¼å¼
- âœ… ä»FlashåŠ è½½åº”ç”¨åˆ°RAM
- âœ… éªŒè¯åº”ç”¨å®Œæ•´æ€§
- âœ… è·³è½¬åˆ°åº”ç”¨å…¥å£ç‚¹

**å¯åŠ¨æµç¨‹**:
```
ROM Bootloader â†’ è¯»å–Flash Header â†’ åŠ è½½SBLåˆ°RAM â†’ æ‰§è¡ŒSBL
```

**æºç ä½ç½®**:
```
MMWAVE_L_SDK_06_01_00_01/examples/drivers/boot/sbl/
```

---

### 3. Application Meta Image (0x00040000)

**ä½ç½®**: 0x40000 - 0xBFFFF  
**å¤§å°**: ~512KB  
**æ–‡ä»¶**: `hello_world_meta.bin`

**ç»“æ„**:
```
Meta Image = Meta Header + R5F Core + DSP Core + RF Firmware
```

**å„éƒ¨åˆ†è¯´æ˜**:

| ç»„ä»¶ | å¤§å° | åŠŸèƒ½ |
|------|------|------|
| Meta Header | ~1KB | æè¿°å¤šæ ¸é•œåƒç»“æ„ |
| R5F Core Image | ~100KB | ARM R5Fä¸»æ§ä»£ç  |
| DSP Core Image | ~50KB | C66x DSPä¿¡å·å¤„ç† |
| RF Firmware | ~20KB | å°„é¢‘å‰ç«¯å›ºä»¶ |

**åŠ è½½è¿‡ç¨‹**:
```
SBLè¯»å–Meta Header â†’ è§£æå„æ ¸é•œåƒåœ°å€ â†’ ä¾æ¬¡åŠ è½½åˆ°RAM â†’ å¯åŠ¨å„æ ¸
```

---

## ğŸ”„ å¯åŠ¨æµç¨‹è¯¦è§£

### å®Œæ•´å¯åŠ¨é“¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Power On /  â”‚
â”‚   Reset     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ROM Bootloader (ç‰‡ä¸ŠROM)    â”‚
â”‚  - åˆå§‹åŒ–æœ€å°ç³»ç»Ÿ             â”‚
â”‚  - æ£€æµ‹å¯åŠ¨æ¨¡å¼(SOP)          â”‚
â”‚  - è¯»å–Flash Header(0x0)     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŠ è½½SBLåˆ°SRAM (0x100å¼€å§‹)   â”‚
â”‚  - æ ¹æ®Headerä¸­çš„sizeè¯»å–    â”‚
â”‚  - åŠ è½½åˆ°loadAddress         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰§è¡ŒSBL (entryPoint)        â”‚
â”‚  - åˆå§‹åŒ–å¤–è®¾                â”‚
â”‚  - è§£æApp Meta Image        â”‚
â”‚  - åŠ è½½å„æ ¸é•œåƒåˆ°RAM         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¯åŠ¨Application             â”‚
â”‚  - R5F Core å¼€å§‹æ‰§è¡Œ         â”‚
â”‚  - DSP Core å¹¶è¡Œè¿è¡Œ         â”‚
â”‚  - RF åˆå§‹åŒ–                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ SOPå¯åŠ¨æ¨¡å¼

### SOPè·³çº¿é…ç½®

| SOPæ¨¡å¼ | è·³çº¿è®¾ç½® | å¯åŠ¨æº | ç”¨é€” |
|---------|---------|--------|------|
| **SOP0** | [0,0,0] | **QSPI Flash** | **æ­£å¸¸è¿è¡Œæ¨¡å¼** â­ |
| SOP1 | [0,0,1] | Reserved | - |
| SOP2 | [0,1,0] | Reserved | - |
| SOP3 | [0,1,1] | Reserved | - |
| **SOP4** | [1,0,0] | **UART Download** | **çƒ§å½•æ¨¡å¼** ğŸ”§ |
| SOP5 | [1,0,1] | Reserved | - |
| SOP6 | [1,1,0] | Reserved | - |
| SOP7 | [1,1,1] | Reserved | - |

**é‡è¦**:
- ğŸ”§ **çƒ§å½•æ—¶**: è®¾ç½®ä¸º**SOP4** (UARTæ¨¡å¼)
- â­ **è¿è¡Œæ—¶**: è®¾ç½®ä¸º**SOP0** (QSPI Flashå¯åŠ¨)

---

## ğŸ“¦ Meta Image æ ¼å¼

### Meta Imageç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Meta Header (512B)              â”‚
â”‚  - Magic Number (éªŒè¯æ ‡è¯†)                  â”‚
â”‚  - Image Count (é•œåƒæ•°é‡)                  â”‚
â”‚  - Image Info[] (å„é•œåƒæè¿°)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            Build Image 1 (R5F)             â”‚
â”‚  - Load Address                            â”‚
â”‚  - Entry Point                             â”‚
â”‚  - Image Size                              â”‚
â”‚  - Binary Data                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            Build Image 2 (DSP)             â”‚
â”‚  - Load Address                            â”‚
â”‚  - Entry Point                             â”‚
â”‚  - Image Size                              â”‚
â”‚  - Binary Data                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            Build Image 3 (RF)              â”‚
â”‚  - Load Address                            â”‚
â”‚  - Image Size                              â”‚
â”‚  - Binary Data                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®Magic Numbers

| Magic | å€¼ | å«ä¹‰ |
|-------|---|------|
| Meta Header Magic | `0x4D535452` ("MSTR") | Meta Imageæ ‡è¯† |
| R5F Core Magic | `0xA95316AD` | APPSS (R5F) |
| DSP Core Magic | `0xD59246F1` | DSS (C66x) |
| RF Core Magic | `0xFECB36DE` | FECSS (RF) |

---

## ğŸ› ï¸ çƒ§å½•åœ°å€å¯¹ç…§è¡¨

### çƒ§å½•å‘½ä»¤å‚è€ƒ

| çƒ§å½•å†…å®¹ | æ–‡ä»¶ | åœ°å€ | å‘½ä»¤ |
|---------|------|------|------|
| SBL Bootloader | `sbl_meta.bin` | `0x100` | `arprog_cmdline_6844.exe -p COM3 -f sbl_meta.bin -o 0x100` |
| HelloWorld App | `hello_world_meta.bin` | `0x40000` | `arprog_cmdline_6844.exe -p COM3 -f hello_world_meta.bin -o 0x40000` |
| InCabin Demo | `demo_in_cabin_meta.bin` | `0x40000` | `arprog_cmdline_6844.exe -p COM3 -f demo_in_cabin_meta.bin -o 0x40000` |

**æ³¨æ„**:
- Flash Header (0x0) **ä¸éœ€è¦å•ç‹¬çƒ§å½•**ï¼ŒåŒ…å«åœ¨`sbl_meta.bin`ä¸­
- åº”ç”¨åœ°å€å›ºå®šä¸º`0x40000`ï¼Œç”±SBLé…ç½®å†³å®š

---

## ğŸ” Flashå®¹é‡è§„åˆ’

### AWRL6844æ ‡å‡†é…ç½®

**QSPI Flash**: S25FL128S (16MB)

| åˆ†åŒº | èµ·å§‹åœ°å€ | å¤§å° | ç™¾åˆ†æ¯” |
|------|---------|------|--------|
| SBLåŒº | 0x000000 | 256KB | 1.56% |
| AppåŒº | 0x040000 | 512KB | 3.13% |
| **å¯ç”¨ç©ºé—´** | 0x0C0000 | **15.3MB** | **95.31%** |

### åº”ç”¨å¤§å°å‚è€ƒ

| åº”ç”¨ç±»å‹ | å…¸å‹å¤§å° | é€‚åˆå®¹é‡ |
|---------|---------|---------|
| HelloWorld | ~200KB | âœ… å……è¶³ |
| mmWave Demo | ~350KB | âœ… å……è¶³ |
| InCabin Demo | ~980KB | âœ… å……è¶³ |
| å¤æ‚AIåº”ç”¨ | 2-5MB | âœ… å¯ç”¨ |

---

## ğŸ“š å®˜æ–¹æ–‡æ¡£å‚è€ƒ

### SDKæ–‡æ¡£ä½ç½®

```
MMWAVE_L_SDK_06_01_00_01/
â”œâ”€â”€ docs/api_guide_xwrL684x/
â”‚   â”œâ”€â”€ sbl_8md.html              # SBLç”¨æˆ·æŒ‡å—
â”‚   â”œâ”€â”€ EXAMPLES_DRIVERS_SBL.html # SBLç¤ºä¾‹æ–‡æ¡£
â”‚   â””â”€â”€ bootloader_architecture.html # å¯åŠ¨æ¶æ„
â”‚
â””â”€â”€ examples/drivers/boot/
    â”œâ”€â”€ sbl/                      # SBLæºç 
    â”œâ”€â”€ sbl_lite/                 # ç²¾ç®€ç‰ˆSBL
    â””â”€â”€ spibooting/               # SPIå¯åŠ¨ç¤ºä¾‹
```

### å†…å­˜å¸ƒå±€å®šä¹‰æ–‡ä»¶

```c
// SDKä¸­çš„å®šä¹‰æ–‡ä»¶
MMWAVE_L_SDK_06_01_00_01/source/drivers/bootloader/sbl.h

#define SBL_FLASH_OFFSET_SBL        0x00000100U
#define SBL_FLASH_OFFSET_APPIMAGE   0x00040000U
#define SBL_FLASH_SIZE_SBL          0x0003FF00U
#define SBL_FLASH_SIZE_APPIMAGE     0x00080000U
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. åœ°å€å¯¹é½è¦æ±‚
- Flashæ“ä½œå¿…é¡»256å­—èŠ‚å¯¹é½
- é•œåƒå¤§å°å»ºè®®4KBå¯¹é½

### 2. çƒ§å½•é¡ºåº
1. **å¿…é¡»å…ˆçƒ§å½•SBL** (åœ°å€0x100)
2. å†çƒ§å½•åº”ç”¨ (åœ°å€0x40000)
3. é¡ºåºé”™è¯¯ä¼šå¯¼è‡´æ— æ³•å¯åŠ¨

### 3. Flashæ“¦é™¤
- çƒ§å½•å·¥å…·ä¼šè‡ªåŠ¨æ“¦é™¤ç›®æ ‡åŒºåŸŸ
- æ“¦é™¤ä»¥Sectorä¸ºå•ä½ï¼ˆ256KBï¼‰
- å…¨ç‰‡æ“¦é™¤ä¼šæ¸…é™¤æ‰€æœ‰å†…å®¹

### 4. éªŒè¯æ–¹æ³•
```bash
# è¯»å–Flashå†…å®¹éªŒè¯
arprog_cmdline_6844.exe -p COM3 -r 0x100 -s 256 -o verify.bin
```

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [README.md](./README.md) - é¡¹ç›®æ¦‚è¿°
- [æ“ä½œæŒ‡å—.md](./æ“ä½œæŒ‡å—.md) - çƒ§å½•æ­¥éª¤
- [1-SBL_Bootloader/README.md](./1-SBL_Bootloader/README.md) - SBLè¯¦è§£

---

**æ›´æ–°æ—¥æœŸ**: 2025-12-12  
**SDKç‰ˆæœ¬**: 06.01.00.01  
**å‚è€ƒæ¥æº**: TIå®˜æ–¹SDKæ–‡æ¡£ + æºç åˆ†æ
