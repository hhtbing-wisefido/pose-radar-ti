# 📋 AWRL6844雷达健康检测-02-方案确认

> **目标**: 确认最终实施方案
> **确认日期**: 2026-01-05
> **状态**: ✅ 已确认

---

## 1. 方案确认

### 1.1 选定方案

| 项目               | 确认内容                                |
| ------------------ | --------------------------------------- |
| **基础方案** | ✅**方案A：基于InCabin Demo扩展** |
| **基础工程** | AWRL6844_InCabin_Demos (Radar Toolbox)  |
| **预计工期** | Phase 1: 8天 / Phase 2: 2周             |

### 1.2 功能范围确认

```
┌─────────────────────────────────────────────────────────────────┐
│              最终功能范围                                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Phase 1A（5天）- 核心功能                                       │
│  ├── ✅ 人存检测 (直接可用)                                      │
│  ├── ✅ 姿态检测 (5类：站/坐/躺/走/跌倒)                          │
│  └── ✅ 跌倒检测 + 告警                                          │
│                                                                 │
│  Phase 1B（3天）- 辅助功能                                       │
│  ├── ✅ 杂波移除优化                                             │
│  ├── ✅ 背景学习（首次启动采集）                                  │
│  └── ✅ 区域划分（床区/活动区）                                   │
│                                                                 │
│  Phase 2（2周）- 扩展研究                                        │
│  ├── ⚠️ 呼吸检测尝试（利用室内环境优势）                          │
│  └── ⚠️ 人数统计（点云聚类）                                     │
│                                                                 │
│  不实现：                                                        │
│  ├── ❌ 心率检测（由睡眠板负责）                                  │
│  └── ❌ 睡眠板通信接口（不预留）                                  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. 用户确认记录

| 问题                         | 用户决定                            |
| ---------------------------- | ----------------------------------- |
| 呼吸检测是否提升优先级？     | ✅**可尝试**（Phase 2）       |
| 是否需要区域划分功能？       | ✅**划分区域**（床区/活动区） |
| 是否需要预留睡眠板通信接口？ | ❌**不需要预留**              |
| 背景学习是否加入？           | ✅**加入**（Phase 1B）        |

---

## 3. 功能优先级矩阵

| 优先级       | 功能       | 阶段     | 说明            |
| ------------ | ---------- | -------- | --------------- |
| **P0** | 人存检测   | Phase 1A | 直接使用InCabin |
| **P0** | 姿态检测   | Phase 1A | 移植pose.c逻辑  |
| **P0** | 跌倒检测   | Phase 1A | 状态机判断      |
| **P1** | 杂波移除   | Phase 1B | 优化MTI参数     |
| **P1** | 背景学习   | Phase 1B | 首次启动采集    |
| **P1** | 区域划分   | Phase 1B | 床区/活动区     |
| **P2** | 呼吸检测   | Phase 2  | 尝试性开发      |
| **P2** | 人数统计   | Phase 2  | 点云聚类        |
| ❌           | 心率检测   | -        | 不实现          |
| ❌           | 睡眠板接口 | -        | 不预留          |

---

## 4. 区域划分设计

### 4.1 区域定义

```
┌─────────────────────────────────────────────────────────────────┐
│                        监测房间                                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────────┐                                               │
│   │  🛏️ 床区    │    雷达位置: 壁挂/吸顶                         │
│   │  Zone A     │         ↘                                     │
│   │             │          📡                                   │
│   └─────────────┘                                               │
│                                                                 │
│   ┌─────────────────────────────────────┐                       │
│   │         🚶 活动区 Zone B            │                       │
│   │                                     │                       │
│   └─────────────────────────────────────┘                       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 4.2 区域监测策略

| 区域                      | 主要监测  | 次要监测     | 告警策略         |
| ------------------------- | --------- | ------------ | ---------------- |
| **床区 (Zone A)**   | 躺姿确认  | 呼吸检测(P2) | 长时间无动作告警 |
| **活动区 (Zone B)** | 姿态+跌倒 | 活动轨迹     | 跌倒立即告警     |

### 4.3 区域配置方式

```
CLI命令设计（建议）:
  zoneConfig 0 <x1> <y1> <x2> <y2>    # Zone A (床区)
  zoneConfig 1 <x1> <y1> <x2> <y2>    # Zone B (活动区)
  
或通过配置文件:
  bedZone = [x1, y1, x2, y2]
  activityZone = [x1, y1, x2, y2]
```

---

## 5. 背景学习设计

### 5.1 工作流程

```
┌─────────────────────────────────────────────────────────────────┐
│                    背景学习流程                                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. 首次启动                                                     │
│     └── 检测到无配置文件 → 进入"学习模式"                         │
│                                                                 │
│  2. 学习模式（约30秒）                                           │
│     ├── 确保房间无人                                             │
│     ├── 采集N帧静态点云                                          │
│     ├── 记录所有静态回波位置+强度                                 │
│     └── 保存为"背景模型"                                         │
│                                                                 │
│  3. 正常模式                                                     │
│     ├── 加载背景模型                                             │
│     ├── 实时点云 - 背景点云 = 有效目标                            │
│     └── 减少家具、墙壁误检                                        │
│                                                                 │
│  4. 重新学习（可选）                                              │
│     └── CLI命令: learnBackground                                 │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 5.2 技术实现要点

| 要点     | 说明                              |
| -------- | --------------------------------- |
| 采集帧数 | 100帧（约3-5秒）                  |
| 存储内容 | 点云位置(x,y,z) + 强度 + 出现频率 |
| 判断阈值 | 出现频率>90%的点视为背景          |
| 存储位置 | Flash（断电保持）                 |

---

## 6. 实施章节对照

实施大纲采用章节结构，便于逐章展开讨论：

### Phase 1A：核心功能

| 章节  | 内容         | 对应功能                |
| ----- | ------------ | ----------------------- |
| 第1章 | 环境搭建     | 编译InCabin Demo        |
| 第2章 | 人存检测验证 | 验证occupancyClassifier |
| 第3章 | 姿态检测开发 | 移植pose.c + 特征适配   |
| 第4章 | 跌倒检测开发 | 状态机 + 告警           |

### Phase 1B：辅助功能

| 章节  | 内容         | 对应功能       |
| ----- | ------------ | -------------- |
| 第5章 | 杂波移除优化 | 调优MTI参数    |
| 第6章 | 背景学习开发 | 采集+存储+加载 |
| 第7章 | 区域划分开发 | Zone配置+策略  |

### Phase 2：扩展研究

| 章节   | 内容           | 对应功能          |
| ------ | -------------- | ----------------- |
| 第8章  | 呼吸检测研究   | 相位提取+信号处理 |
| 第9章  | 人数统计开发   | 点云聚类          |
| 第10章 | 综合测试与验收 | 完整功能测试      |

---

## 7. 可用资源

### 7.1 现有数据集

```
知识库/Pose_And_Fall_Detection/retraining_resources/dataset/classes/
├── falling/   (24个CSV文件)
├── lying/     (6个CSV文件)
├── sitting/   (9个CSV文件)
├── standing/  (8个CSV文件)
└── walking/   (5个CSV文件)
```

**用途**：

- 第3章：特征提取参考 + 离线验证
- 第10章：与实际测试结果对比

> 📚 详见实施大纲 [附录A 现有数据集资源](./AWRL6844雷达健康检测-03-实施目录大纲.md#附录a-现有数据集资源)

---

## 8. 验收标准

| 功能     | 验收标准             | 测试方法        |
| -------- | -------------------- | --------------- |
| 人存检测 | ≥98%检测率          | 有人/无人各20次 |
| 姿态检测 | ≥90%准确率          | 5类×20次       |
| 跌倒检测 | ≥95%检测率，<5%误报 | 模拟跌倒30次    |
| 背景学习 | 家具不误报           | 空房间+家具场景 |
| 区域划分 | 正确识别目标所在区域 | 床区/活动区切换 |
| 呼吸检测 | 能检测到即成功       | 静止躺姿5分钟   |

---

## 9. 确认签字

| 项目     | 确认                                |
| -------- | ----------------------------------- |
| 方案选择 | ✅ 方案A（InCabin Demo扩展）        |
| 功能范围 | ✅ 人存+姿态+跌倒+背景学习+区域划分 |
| 工期接受 | ✅ Phase 1: 8天 / Phase 2: 2周      |
| 用户确认 | ✅ 2026-01-05                       |

---

> 📌 **下一步**: [AWRL6844雷达健康检测-03-实施目录大纲](./AWRL6844雷达健康检测-03-实施目录大纲.md)
> 📅 **确认日期**: 2026-01-05
