# ğŸ”§ é—®é¢˜36ä¿®å¤æŒ‡å— - è¯¦ç»†å®æ–½æ­¥éª¤

**åˆ›å»ºæ—¥æœŸ**: 2026-01-14
**çŠ¶æ€**: ä¿®å¤è¿›è¡Œä¸­ - å‡†å¤‡å·¥ä½œå·²å®Œæˆ

---

## ğŸ“‹ ä¿®å¤æ¦‚è¿°

### é—®é¢˜æè¿°
- CLIæ¡†æ¶æœªä½¿ç”¨SDKæ ‡å‡†å®ç°ï¼ˆç¼ºå°‘enableMMWaveExtension=1Uï¼‰
- MCBç»“æ„ç¼ºå°‘å…³é”®å­—æ®µï¼ˆcommandUartHandle, ctrlHandleç­‰ï¼‰
- å¯åŠ¨æµç¨‹ä¸å®Œæ•´ï¼ˆç¼ºå°‘APLLé…ç½®ã€å·¥å‚æ ¡å‡†ç­‰ï¼‰
- å¯¼è‡´SDK Visualizerä¸å…¼å®¹ï¼ŒsensorStartå¤±è´¥ï¼ˆé”™è¯¯-204476406ï¼‰

### ä¿®å¤ç›®æ ‡
100%æŒ‰ç…§SDKæ ‡å‡†å®ç°ï¼Œä¸å·æ‡’ã€ä¸ç®€åŒ–

---

## âœ… å·²å®Œæˆå·¥ä½œï¼ˆ2026-01-14ï¼‰

### 1. SDKæºç æ·±åº¦å­¦ä¹ 
- âœ… mmw_cli.c (2342è¡Œ) - CLIæ¡†æ¶å®ç°
- âœ… mmwave_demo.c MmwStart() - å®Œæ•´å¯åŠ¨æµç¨‹
- âœ… MmwDemo_configAndEnableApll() - APLLé…ç½®å®ç°
- âœ… MmwDemo_MSS_MCBç»“æ„ (927-1287è¡Œ) - MCBæ ‡å‡†è®¾è®¡

### 2. æ–°MCBç»“æ„è®¾è®¡
- âœ… åˆ›å»º `health_detect_main_NEW.h`
- âœ… æ·»åŠ æ‰€æœ‰ç¼ºå¤±å­—æ®µ
- âœ… å®Œå…¨å¯¹é½SDKæ ‡å‡†

### 3. æ–‡æ¡£æ›´æ–°
- âœ… HealthDetecté¡¹ç›®é‡å»ºæ€»ç»“.md - è®°å½•è¯¦ç»†å­¦ä¹ æˆæœ
- âœ… æœ¬ä¿®å¤æŒ‡å— - æä¾›å®æ–½è·¯çº¿å›¾

---

## ğŸ”§ å¾…å®Œæˆå·¥ä½œ

### ç¬¬1é˜¶æ®µï¼šMCBç»“æ„æ›¿æ¢

#### æ­¥éª¤1.1ï¼šå¤‡ä»½å½“å‰æ–‡ä»¶
```powershell
cd D:\7.project\TI_Radar_Project\project-code\AWRL6844_HealthDetect\src\mss\source

# å¤‡ä»½æ—§æ–‡ä»¶
Copy-Item health_detect_main.h health_detect_main_OLD.h
Copy-Item health_detect_main.c health_detect_main_OLD.c
Copy-Item cli.h cli_OLD.h
Copy-Item cli.c cli_OLD.c
Copy-Item radar_control.c radar_control_OLD.c
```

#### æ­¥éª¤1.2ï¼šæ›¿æ¢MCBå¤´æ–‡ä»¶
```powershell
# æ›¿æ¢ä¸ºæ–°çš„MCBç»“æ„
Copy-Item health_detect_main_NEW.h health_detect_main.h
```

#### æ­¥éª¤1.3ï¼šæ›´æ–°health_detect_main.cä¸­çš„MCBåˆå§‹åŒ–
éœ€è¦ä¿®æ”¹çš„å…³é”®éƒ¨åˆ†ï¼š

```c
// æ—§ä»£ç ï¼ˆéœ€è¦åˆ é™¤ï¼‰
HealthDetect_MCB_t gHealthDetectMCB = {0};

// æ–°ä»£ç ï¼ˆéœ€è¦æ·»åŠ ï¼‰
HealthDetect_MCB_t gHealthDetectMCB = {
    .loggingUartHandle = NULL,
    .commandUartHandle = NULL,
    .ctrlHandle = NULL,
    .adcBuffHandle = NULL,
    .edmaHandle = NULL,
    .numEdmaEventQueues = 0,
    .sensorStartCount = 0,
    .sensorStopCount = 0,
    .isSensorStarted = 0,
    .isSensorStopped = 0,
    .apllFreqShiftEnable = 0,
    .oneTimeConfigDone = 0,
    .state = HEALTH_DETECT_STATE_INIT,
    .errorCode = 0,
    // ... å…¶ä»–å­—æ®µåˆå§‹åŒ–
};
```

#### æ­¥éª¤1.4ï¼šæ›´æ–°æ‰€æœ‰MCBå­—æ®µå¼•ç”¨
éœ€è¦åœ¨ä»¥ä¸‹æ–‡ä»¶ä¸­æŸ¥æ‰¾æ›¿æ¢ï¼š

**health_detect_main.c**:
- `gHealthDetectMCB.uartHandle` â†’ `gHealthDetectMCB.loggingUartHandle`
- `gHealthDetectMCB.mmWaveHandle` â†’ `gHealthDetectMCB.ctrlHandle`
- æ·»åŠ  `gHealthDetectMCB.commandUartHandle` åˆå§‹åŒ–
- æ·»åŠ  `gHealthDetectMCB.adcBuffHandle` åˆå§‹åŒ–

**cli.c**:
- éœ€è¦å®Œå…¨é‡æ„ï¼ˆè§ç¬¬2é˜¶æ®µï¼‰

**radar_control.c**:
- `gMmWaveHandle` â†’ `gHealthDetectMCB.ctrlHandle`
- `gAdcBufHandle` â†’ `gHealthDetectMCB.adcBuffHandle`
- æ·»åŠ APLLé…ç½®ç›¸å…³ä»£ç 

**dpc_control.c**:
- æ£€æŸ¥æ‰€æœ‰MCBå¼•ç”¨
- æ›´æ–°ä¿¡å·é‡å¼•ç”¨

**tlv_output.c**:
- `gHealthDetectMCB.uartHandle` â†’ `gHealthDetectMCB.loggingUartHandle`

### ç¬¬2é˜¶æ®µï¼šCLIæ¡†æ¶é‡æ„

#### æ­¥éª¤2.1ï¼šåˆ›å»ºCLI_MCBå…¨å±€å˜é‡
åœ¨cli.cä¸­æ·»åŠ ï¼š

```c
// å‚è€ƒmmw_cli.cç¬¬79è¡Œ
CLI_MCB gCLI;

// å…¨å±€å˜é‡å®šä¹‰
extern HealthDetect_MCB_t gHealthDetectMCB;
```

#### æ­¥éª¤2.2ï¼šå®ç°CLI_open()æ ‡å‡†é…ç½®
åœ¨cli.cä¸­æ›¿æ¢CLI_openRadar()ä¸ºæ ‡å‡†å®ç°ï¼š

```c
// å‚è€ƒmmw_cli.cç¬¬2093-2280è¡Œ
int32_t CLI_open(CLI_Cfg* ptrCLICfg)
{
    CLI_Cfg cliCfg;
    int32_t cnt = 0;
    
    // åˆå§‹åŒ–CLIé…ç½®
    memset(&cliCfg, 0, sizeof(CLI_Cfg));
    
    // æ ‡å‡†é…ç½®ï¼ˆå…³é”®ï¼ï¼‰
    cliCfg.cliPrompt                    = "mmwDemo:/>";
    cliCfg.cliBanner                    = "Health Detect Demo\r\n";
    cliCfg.UartHandle                   = gHealthDetectMCB.commandUartHandle;  // ä½¿ç”¨MCB.commandUartHandle
    cliCfg.taskPriority                 = CLI_TASK_PRIORITY;
    cliCfg.mmWaveHandle                 = gHealthDetectMCB.ctrlHandle;         // ä½¿ç”¨MCB.ctrlHandle
    cliCfg.enableMMWaveExtension        = 1U;                                  // å…³é”®ï¼SDK Visualizerå…¼å®¹
    cliCfg.usePolledMode                = true;
    cliCfg.overridePlatform             = false;
    
    // æ³¨å†Œå‘½ä»¤è¡¨
    cliCfg.tableEntry[cnt].cmd            = "sensorStop";
    cliCfg.tableEntry[cnt].helpString     = "<FrameStopMode>";
    cliCfg.tableEntry[cnt].cmdHandlerFxn  = CLI_MMWaveSensorStop;
    cnt++;
    
    cliCfg.tableEntry[cnt].cmd            = "channelCfg";
    cliCfg.tableEntry[cnt].helpString     = "<RxChCtrlBitMask> <TxChCtrlBitMask> <Reserved>";
    cliCfg.tableEntry[cnt].cmdHandlerFxn  = CLI_MMWaveChannelCfg;
    cnt++;
    
    // ... æ·»åŠ æ‰€æœ‰æ ‡å‡†å‘½ä»¤
    
    // è°ƒç”¨SDKçš„CLI_open
    if (CLI_open(&cliCfg) < 0) {
        return -1;
    }
    
    return 0;
}
```

#### æ­¥éª¤2.3ï¼šå®ç°mmWaveæ‰©å±•å‘½ä»¤å¤„ç†
å‚è€ƒmmw_cli.cç¬¬210ã€372ã€589è¡Œçš„å®ç°

### ç¬¬3é˜¶æ®µï¼šradar_control.cå®Œå–„

#### æ­¥éª¤3.1ï¼šæ·»åŠ HealthDetect_configAndEnableApll()
å‚è€ƒmmwave_demo.cç¬¬395-450è¡Œå®ç°ï¼š

```c
int32_t HealthDetect_configAndEnableApll(float apllFreqMHz, uint8_t saveRestoreCalData)
{
    int32_t retVal = 0;
    int32_t errCode;
    
    // Step 1: å…³é—­APLL
    retVal = MMWave_FecssDevClockCtrl(&gHealthDetectMCB.mmWaveCfg.initCfg, 
                                       MMWAVE_APLL_CLOCK_DISABLE, &errCode);
    if (retVal != 0) {
        DebugP_log("Error: APLL disable failed\r\n");
        return -1;
    }
    
    // Step 2: é…ç½®APLLå¯„å­˜å™¨
    retVal = MMWave_ConfigApllReg(apllFreqMHz);
    if (retVal != 0) {
        DebugP_log("Error: APLL config failed\r\n");
        return -1;
    }
    
    // Step 3: æ¢å¤æ ¡å‡†æ•°æ®ï¼ˆå¦‚æœRESTOREæ¨¡å¼ï¼‰
    if (saveRestoreCalData == RESTORE_APLL_CALIB_DATA) {
        if (apllFreqMHz == APLL_FREQ_400MHZ) {
            retVal = MMWave_SetApllCalResult(&gHealthDetectMCB.defaultApllCalRes);
        } else {
            retVal = MMWave_SetApllCalResult(&gHealthDetectMCB.downShiftedApllCalRes);
        }
        if (retVal != 0) {
            DebugP_log("Error: APLL calibration restore failed\r\n");
            return -1;
        }
    }
    
    // Step 4: å¼€å¯APLL
    retVal = MMWave_FecssDevClockCtrl(&gHealthDetectMCB.mmWaveCfg.initCfg,
                                       MMWAVE_APLL_CLOCK_ENABLE, &errCode);
    if (retVal != 0) {
        DebugP_log("Error: APLL enable failed\r\n");
        return -1;
    }
    
    // Step 5: ä¿å­˜æ ¡å‡†æ•°æ®ï¼ˆå¦‚æœSAVEæ¨¡å¼ï¼‰
    if (saveRestoreCalData == SAVE_APLL_CALIB_DATA) {
        if (apllFreqMHz == APLL_FREQ_400MHZ) {
            retVal = MMWave_GetApllCalResult(&gHealthDetectMCB.defaultApllCalRes);
        } else {
            retVal = MMWave_GetApllCalResult(&gHealthDetectMCB.downShiftedApllCalRes);
        }
        if (retVal != 0) {
            DebugP_log("Error: APLL calibration save failed\r\n");
            return -1;
        }
    }
    
    DebugP_log("APLL configured at %.1f MHz\r\n", apllFreqMHz);
    return 0;
}
```

#### æ­¥éª¤3.2ï¼šå®Œå–„RadarControl_sensorStart()
å‚è€ƒmmwave_demo.c MmwStart()å®Œæ•´æµç¨‹ï¼š

```c
int32_t RadarControl_sensorStart(void)
{
    int32_t retVal = 0;
    int32_t errCode;
    
    // Step 1: ADCBufé…ç½®
    // TODO: å®ç°MmwDemo_ADCBufConfigç­‰æ•ˆä»£ç 
    
    // Step 2: å·¥å‚æ ¡å‡†ï¼ˆå¦‚æœéœ€è¦ï¼‰
    // TODO: å®ç°mmwDemo_factoryCalç­‰æ•ˆä»£ç 
    
    // Step 3: APLLé…ç½®
    if (gHealthDetectMCB.apllFreqShiftEnable && !gHealthDetectMCB.oneTimeConfigDone) {
        // å†·å¯åŠ¨ + ç§»é¢‘
        retVal = HealthDetect_configAndEnableApll(APLL_FREQ_396MHZ, SAVE_APLL_CALIB_DATA);
    } else if (gHealthDetectMCB.oneTimeConfigDone) {
        // çƒ­å¯åŠ¨
        gHealthDetectMCB.mmWaveCfg.initCfg.iswarmstart = TRUE;
        retVal = HealthDetect_configAndEnableApll(APLL_FREQ_400MHZ, RESTORE_APLL_CALIB_DATA);
    } else {
        // å†·å¯åŠ¨ + æ— ç§»é¢‘
        retVal = HealthDetect_configAndEnableApll(APLL_FREQ_400MHZ, SAVE_APLL_CALIB_DATA);
    }
    
    if (retVal != 0) {
        return retVal;
    }
    
    // Step 4: RFç”µæºé…ç½®
    retVal = MMWave_FecssRfPwrOnOff(gHealthDetectMCB.mmWaveCfg.txEnbl,
                                     gHealthDetectMCB.mmWaveCfg.rxEnbl, &errCode);
    
    // Step 5: MMWave_open
    retVal = MMWave_open(gHealthDetectMCB.ctrlHandle, &gHealthDetectMCB.mmWaveCfg, &errCode);
    
    // Step 6: MMWave_config
    retVal = MMWave_config(gHealthDetectMCB.ctrlHandle, &gHealthDetectMCB.mmWaveCfg, &errCode);
    
    // Step 7: MMWave_start
    retVal = MMWave_start(gHealthDetectMCB.ctrlHandle, &gHealthDetectMCB.mmWaveCfg.strtCfg, &errCode);
    
    if (retVal == 0) {
        gHealthDetectMCB.isSensorStarted = 1;
        gHealthDetectMCB.sensorStartCount++;
        gHealthDetectMCB.oneTimeConfigDone = 1;
    }
    
    return retVal;
}
```

### ç¬¬4é˜¶æ®µï¼šç¼–è¯‘éªŒè¯

#### æ­¥éª¤4.1ï¼šCCSé¡¹ç›®æ¸…ç†
```
1. åœ¨CCSä¸­åˆ é™¤æ‰€æœ‰é¡¹ç›®
2. ä»Systemé¡¹ç›®é‡æ–°å¯¼å…¥
3. ç¡®ä¿ä½¿ç”¨æœ€æ–°çš„project-codeæºç 
```

#### æ­¥éª¤4.2ï¼šé€ä¸ªç¼–è¯‘
```
1. å…ˆç¼–è¯‘MSSé¡¹ç›® - ä¿®å¤æ‰€æœ‰é”™è¯¯
2. å†ç¼–è¯‘DSSé¡¹ç›® - ä¿®å¤æ‰€æœ‰é”™è¯¯
3. æœ€åç¼–è¯‘Systemé¡¹ç›® - ç”Ÿæˆ.appimage
```

#### æ­¥éª¤4.3ï¼šæ£€æŸ¥è¾“å‡º
```
éªŒè¯æ–‡ä»¶æ˜¯å¦ç”Ÿæˆï¼š
- health_detect_6844_mss/Release/health_detect_6844_mss_img.Release.rig
- health_detect_6844_dss/Release/health_detect_6844_dss_img.Release.rig
- health_detect_6844_system/Release/health_detect_6844_system.Release.appimage
```

### ç¬¬5é˜¶æ®µï¼šçƒ§å½•æµ‹è¯•

#### æ­¥éª¤5.1ï¼šUniFlashçƒ§å½•
```
1. æ‰“å¼€UniFlash
2. é€‰æ‹©.appimageæ–‡ä»¶
3. çƒ§å½•åˆ°æ¿å¡
```

#### æ­¥éª¤5.2ï¼šä¸²å£æµ‹è¯•
```
1. è¿æ¥å‘½ä»¤ç«¯å£ï¼ˆæ³¢ç‰¹ç‡115200ï¼‰
2. å‘é€é…ç½®å‘½ä»¤
3. å‘é€sensorStart
4. æ£€æŸ¥è¿”å›å€¼ï¼ˆåº”ä¸º0ï¼Œä¸æ˜¯-204476406ï¼‰
```

#### æ­¥éª¤5.3ï¼šSDK Visualizeræµ‹è¯•
```
1. æ‰“å¼€mmWave SDK Visualizer
2. é€‰æ‹©AWRL6844è®¾å¤‡
3. åŠ è½½é…ç½®æ–‡ä»¶
4. ç‚¹å‡»"Sensor Start"
5. éªŒè¯ï¼š
   - é…ç½®ä¸‹å‘æ— é”™è¯¯
   - sensorStartæˆåŠŸ
   - ç‚¹äº‘æ•°æ®æ˜¾ç¤º
```

---

## ğŸ“ ä¿®æ”¹æ£€æŸ¥æ¸…å•

æ¯å®Œæˆä¸€ä¸ªæ­¥éª¤ï¼Œåœ¨å¯¹åº”çš„æ¡†ä¸­æ‰“å‹¾ï¼š

### MCBç»“æ„æ›¿æ¢
- [ ] å¤‡ä»½æ‰€æœ‰æºæ–‡ä»¶
- [ ] æ›¿æ¢health_detect_main.h
- [ ] æ›´æ–°health_detect_main.cçš„MCBåˆå§‹åŒ–
- [ ] æ›´æ–°health_detect_main.cçš„MCBå¼•ç”¨
- [ ] æ›´æ–°cli.cçš„MCBå¼•ç”¨
- [ ] æ›´æ–°radar_control.cçš„MCBå¼•ç”¨
- [ ] æ›´æ–°dpc_control.cçš„MCBå¼•ç”¨
- [ ] æ›´æ–°tlv_output.cçš„MCBå¼•ç”¨

### CLIæ¡†æ¶é‡æ„
- [ ] åˆ›å»ºCLI_MCBå…¨å±€å˜é‡
- [ ] å®ç°CLI_open()æ ‡å‡†é…ç½®
- [ ] è®¾ç½®enableMMWaveExtension=1U
- [ ] æ³¨å†Œæ‰€æœ‰æ ‡å‡†CLIå‘½ä»¤
- [ ] å®ç°mmWaveæ‰©å±•å‘½ä»¤å¤„ç†

### APLLé…ç½®å®Œå–„
- [ ] å®ç°HealthDetect_configAndEnableApll()
- [ ] æ·»åŠ æ ¡å‡†æ•°æ®ä¿å­˜/æ¢å¤é€»è¾‘
- [ ] æ”¯æŒ396MHz/400MHzé¢‘ç‡åˆ‡æ¢
- [ ] å®Œå–„é”™è¯¯å¤„ç†

### å¯åŠ¨æµç¨‹å®Œå–„
- [ ] å®ç°ADCBufé…ç½®
- [ ] å®ç°å·¥å‚æ ¡å‡†
- [ ] å®ç°å®Œæ•´MmwStart()æµç¨‹
- [ ] æ·»åŠ LVDSé…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰
- [ ] æ·»åŠ ç›‘æ§å™¨é…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰

### ç¼–è¯‘éªŒè¯
- [ ] MSSé¡¹ç›®ç¼–è¯‘é€šè¿‡
- [ ] DSSé¡¹ç›®ç¼–è¯‘é€šè¿‡
- [ ] Systemé¡¹ç›®ç¼–è¯‘é€šè¿‡
- [ ] .appimageæ–‡ä»¶ç”Ÿæˆ

### çƒ§å½•æµ‹è¯•
- [ ] UniFlashçƒ§å½•æˆåŠŸ
- [ ] ä¸²å£è¿æ¥æ­£å¸¸
- [ ] sensorStartè¿”å›0
- [ ] SDK Visualizeré…ç½®æˆåŠŸ
- [ ] ç‚¹äº‘æ•°æ®è¾“å‡ºæ­£å¸¸

---

## ğŸ¯ é¢„æœŸç»“æœ

å®Œæˆæ‰€æœ‰æ­¥éª¤åï¼Œåº”è¯¥è¾¾åˆ°ï¼š
1. âœ… sensorStartå‘½ä»¤è¿”å›æˆåŠŸï¼ˆ0ï¼Œè€Œä¸æ˜¯-204476406ï¼‰
2. âœ… SDK Visualizerèƒ½å¤Ÿæ­£å¸¸è¿æ¥å’Œæ§åˆ¶è®¾å¤‡
3. âœ… é…ç½®å‘½ä»¤ä¸‹å‘æ— é”™è¯¯
4. âœ… ç‚¹äº‘æ•°æ®æ­£å¸¸è¾“å‡º
5. âœ… TLVæ•°æ®æ ¼å¼æ­£ç¡®
6. âœ… 100%ç¬¦åˆéœ€æ±‚æ–‡æ¡£v2.6è¦æ±‚

---

> ğŸ“Œ **é‡è¦æé†’**: æ¯æ¬¡ä¿®æ”¹åå¿…é¡»æ›´æ–°æ–‡æ¡£ï¼Œè®°å½•ä¿®æ”¹å†…å®¹å’Œé‡åˆ°çš„é—®é¢˜
> ğŸ”– **å‚è€ƒæ–‡æ¡£**: HealthDetecté¡¹ç›®é‡å»ºæ€»ç»“.md - é™„å½•éƒ¨åˆ†æœ‰è¯¦ç»†çš„SDKå­¦ä¹ æˆæœ
