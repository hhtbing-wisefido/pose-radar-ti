# 🔬 AWRL6844 Flash配置功能深度研究报告

> **研究日期**: 2025-12-20  
> **研究对象**: InCabin Demo Flash配置读取功能  
> **研究状态**: 🚧 进行中

---

## 📊 研究进度总览

| 研究项目 | 状态 | 完成度 | 备注 |
|---------|------|--------|------|
| InCabin Demo Flash CLI命令 | 🔴 待研究 | 0% | 需要实际硬件测试 |
| Flash存储区域地址映射 | 🔴 待研究 | 0% | 需查看SDK文档 |
| Flash数据格式和结构 | 🔴 待研究 | 0% | 需分析源码 |
| 多配置槽位支持 | 🔴 待研究 | 0% | 需验证 |
| 校准数据存储位置 | 🔴 待研究 | 0% | 需分析内存映射 |
| UniFlash预烧录方法 | 🔴 待研究 | 0% | 需实际测试 |

**图例**：🟢 已完成 | 🟡 进行中 | 🔴 未开始 | ⚠️ 遇到问题

---

## 🎯 研究目标

### 主要目标
1. **找到InCabin Demo的Flash CLI命令**
   - 如何保存配置到Flash
   - 如何从Flash加载配置
   - 如何保存校准数据

2. **了解Flash存储架构**
   - Flash地址映射
   - 存储区域划分
   - 数据格式

3. **验证实际功能**
   - 配置持久化
   - 独立部署
   - 校准数据保持

---

## 📂 已发现的资源

### 文档资源

#### InCabin Demo官方文档
```
位置：
D:\7.项目资料\Ti雷达项目\知识库\雷达模块\RADAR-TOOLBOX\
└── radar_toolbox_3_30_00_06\source\ti\examples\
    └── Automotive_InCabin_Security_and_Safety\AWRL6844_InCabin_Demos\docs\

文档列表：
- AWRL6844_InCabin_Demos_User_Guide.html         ⭐ 主要文档
- Child_Presence_Detection_User_Guide.html       📝 CPD用户指南
- Intrusion_Detection_User_Guide.html            📝 入侵检测指南
- Seat_Belt_Reminder_User_Guide.html             📝 安全带提醒指南
```

**状态**: 🔴 **HTML文档需要用浏览器打开阅读，或转换为可搜索的文本格式**

#### 知识库Markdown文档
```
位置：知识库/知识库PDF转机器可读文件/

AWRL6844相关文档：
- AWRL6844-IWRL6844 评估模块zhcuco8.md
- AWRL6844EVM-规格书swru630a.md
- AWRL6844_CPD_&_SBR_Point_Cloud_Tuning_Guide.md  ⭐ 可能包含Flash信息
- AWRL6844_CPD_&_SBR_Test_Results.md
- AWRL6844_Intruder_Detection_Testing.md
- awrl6844规格书.md
- Migration_from_xWRLx432_to_xWRL6844.md
```

**状态**: 🟡 **已搜索，未发现Flash相关关键词（可能文档未涵盖Flash功能）**

### 配置文件资源

#### InCabin配置文件
```
C:\ti\radar_toolbox_3_30_00_06\tools\visualizers\AWRL6844_Incabin_GUI\
└── src\chirpConfigs6844\
    ├── cpd.cfg                          ✅ 儿童存在检测
    ├── sbr.cfg                          ✅ 安全带提醒
    ├── intrusion_detection.cfg          ✅ 入侵检测
    └── intrusion_detection_LP.cfg       ✅ 低功耗入侵检测
```

**状态**: ✅ **已确认存在，但这些是运行时配置，不是Flash配置命令**

#### 参考：Parking Garage Sensor Flash配置（xWR68xx）
```
C:\ti\radar_toolbox_3_30_00_06\source\ti\examples\
└── Industrial_and_Personal_Electronics\Parking_Garage_Sensor\
    └── chirp_configs\
        ├── parking_garage_sensor_68xx_ISK_setFlashRecord.cfg  📝 写Flash
        └── parking_garage_sensor_68xx_ISK_getFlashRecord.cfg  📝 读Flash
```

**状态**: ⚠️ **仅适用xWR68xx，AWRL6844不支持，但可参考其CLI命令格式**

---

## 🔍 研究方法

### 方法1: 阅读HTML文档 🟡 推荐

**步骤**：
1. 用浏览器打开 `AWRL6844_InCabin_Demos_User_Guide.html`
2. 搜索关键词：
   - "Flash"
   - "persistent"
   - "calibration"
   - "CLI command"
   - "configuration"
3. 查找CLI命令列表章节
4. 查找配置保存/加载说明

**文件位置**：
```
D:\7.项目资料\Ti雷达项目\知识库\雷达模块\RADAR-TOOLBOX\radar_toolbox_3_30_00_06\
└── source\ti\examples\Automotive_InCabin_Security_and_Safety\
    └── AWRL6844_InCabin_Demos\docs\AWRL6844_InCabin_Demos_User_Guide.html
```

**预期发现**：
- CLI命令列表
- Flash相关命令说明
- 配置持久化说明
- 示例配置流程

---

### 方法2: 查看源码 🟡 如果有源码

**目标文件**：
```
AWRL6844_InCabin_Demos源码目录（如果提供）：
- cli.c / cli_mmwave.c          - CLI命令实现
- flash.c / qspi_flash.c        - Flash操作
- calibration.c                 - 校准数据处理
- config_manager.c              - 配置管理
```

**搜索关键词**：
```c
// CLI命令注册
CLI_Cmd("saveConfig", ...)
CLI_Cmd("loadConfig", ...)
CLI_Cmd("flashWrite", ...)

// Flash操作
QSPI_flash_write(...)
QSPI_flash_read(...)

// 校准数据
saveCalibrationData(...)
loadCalibrationData(...)
```

---

### 方法3: 实际硬件测试 ⭐ 最准确

**前提条件**：
- ✅ AWRL6844硬件
- ✅ 烧录好InCabin Demo固件
- ✅ UART连接

**测试步骤**：
1. **启动固件，查看启动信息**
   ```
   连接UART（115200波特率）
   观察启动日志
   ```

2. **尝试help命令**
   ```
   > help
   ```
   **预期**：显示所有可用CLI命令

3. **测试Flash相关命令**
   ```
   可能的命令：
   > saveConfig
   > loadConfig
   > flashWrite
   > flashRead
   > saveCalib
   > loadCalib
   > getFlashRecord
   > setFlashRecord
   ```

4. **查看Flash信息**
   ```
   > flashInfo
   > memoryMap
   ```

5. **测试配置保存流程**
   ```
   步骤：
   1. 发送配置命令（如cpd.cfg内容）
   2. 执行保存命令：saveConfig
   3. 重启设备
   4. 检查配置是否自动加载
   ```

---

### 方法4: 参考其他型号 📚 辅助理解

#### 参考Parking Garage Sensor (xWR68xx)

**Flash CLI命令示例**（需验证AWRL6844是否类似）：
```bash
# 保存静态场景配置到Flash
> setFlashRecord 1 <data>

# 从Flash读取配置
> getFlashRecord 1

# Flash擦除
> eraseFlash <address> <size>
```

**配置文件示例**：
```cfg
% parking_garage_sensor_68xx_ISK_setFlashRecord.cfg

% 保存配置到Flash Record 1
setFlashRecord 1 0x01020304...

% 校验
getFlashRecord 1
```

#### 参考MMWAVE_L_SDK QSPI示例

**SDK示例路径**：
```
C:\ti\MMWAVE_L_SDK_06_01_00_01\examples\drivers\qspi\
├── qspi_flash_diag\           - Flash诊断工具
├── qspi_flash_transfer\       - Flash读写示例
└── qspi_flash_dma_transfer\   - DMA Flash传输
```

**这些示例展示了底层Flash操作，可以了解**：
- Flash地址空间
- 读写函数
- 擦除方法

---

## 📝 初步推测（需验证）

### Flash CLI命令（推测）

基于TI mmWave雷达的通用设计，InCabin Demo可能使用以下命令：

```bash
# === 配置管理 ===
saveConfig [slot]          # 保存当前配置到Flash槽位
loadConfig [slot]          # 从Flash加载配置
getConfigInfo              # 查看配置信息
eraseConfig [slot]         # 擦除配置槽位

# === 校准数据 ===
saveCalibration            # 保存校准数据到Flash
loadCalibration            # 从Flash加载校准数据
resetCalibration           # 重置校准数据

# === Flash操作 ===
flashInfo                  # 显示Flash信息
flashRead <addr> <len>     # 读取Flash数据
flashWrite <addr> <data>   # 写入Flash数据
flashErase <addr> <len>    # 擦除Flash区域

# === 记录管理（如Parking Garage Sensor）===
setFlashRecord <id> <data> # 保存记录到Flash
getFlashRecord <id>        # 读取Flash记录
```

⚠️ **注意**：以上命令**纯属推测**，必须通过实际测试或文档确认！

---

### Flash存储结构（推测）

```
QSPI Flash 内存映射（推测）：

地址范围          大小      用途
--------------------------------------------------
0x00000000     256KB    引导加载器（SBL）
0x00040000     1MB      应用固件（AppImage）
0x00140000     64KB     配置区域
  0x00140000   16KB     - 配置槽位0
  0x00144000   16KB     - 配置槽位1
  0x00148000   16KB     - 配置槽位2
  0x0014C000   16KB     - 配置槽位3
0x00150000     64KB     校准数据区
  0x00150000   16KB     - 背景噪声基线
  0x00154000   16KB     - 环境校准数据
  0x00158000   16KB     - 算法参数
  0x0015C000   16KB     - 保留
0x00160000     剩余     用户数据区
```

⚠️ **注意**：以上地址映射**纯属推测**，实际地址需查看SDK文档或内存映射文件！

---

### 配置数据格式（推测）

```c
// 配置记录结构（推测）
typedef struct {
    uint32_t magic;              // 魔数：0x54495241 (TIRA)
    uint32_t version;            // 版本号
    uint32_t crc32;              // CRC校验
    uint32_t dataLength;         // 数据长度
    
    // 雷达配置参数
    struct {
        uint8_t numTxChannels;
        uint8_t numRxChannels;
        uint16_t numChirps;
        float startFreqGHz;
        float idleTime;
        float rampEndTime;
        // ... 更多参数
    } radarConfig;
    
    // 算法配置
    struct {
        float detectionThreshold;
        uint16_t maxTargets;
        // ... 更多参数
    } algoConfig;
    
    uint8_t reserved[1024];      // 保留
} FlashConfigRecord_t;
```

⚠️ **注意**：以上数据结构**纯属推测**，实际格式需查看源码！

---

## 🎯 下一步行动计划

### 优先级1：阅读官方文档 🔴 必须

**任务**：
- [ ] 打开 `AWRL6844_InCabin_Demos_User_Guide.html`
- [ ] 搜索Flash相关内容
- [ ] 记录所有CLI命令
- [ ] 查找配置保存流程

**预计时间**: 30-60分钟

---

### 优先级2：硬件实测（如果有硬件）⭐ 推荐

**任务**：
- [ ] 连接AWRL6844硬件
- [ ] 烧录InCabin Demo固件
- [ ] 连接UART终端
- [ ] 执行help命令查看所有CLI
- [ ] 测试Flash配置保存/加载
- [ ] 记录实际命令和响应

**预计时间**: 1-2小时

---

### 优先级3：查看源码（如果可用）

**任务**：
- [ ] 确认是否有InCabin Demo源码
- [ ] 查看cli.c找CLI命令实现
- [ ] 查看flash相关源文件
- [ ] 理解配置保存逻辑

**预计时间**: 2-3小时

---

### 优先级4：联系TI技术支持

**问题清单**：
1. InCabin Demo是否支持Flash配置读取？
2. 具体的CLI命令是什么？
3. Flash存储区域的地址映射？
4. 配置数据格式文档在哪里？
5. 如何通过UniFlash预烧录配置？

**联系方式**：
- TI E2E论坛：https://e2e.ti.com
- TI技术支持邮箱

---

## 📊 研究记录

### 2025-12-20

#### 初步调查
- ✅ 确认InCabin Demo固件位置
- ✅ 找到配置文件（cpd.cfg等）
- ✅ 找到官方HTML文档位置
- ❌ HTML文档未转换为可搜索文本
- ❌ Markdown知识库中未发现Flash相关信息

#### 发现的问题
1. **文档格式限制**：HTML文档不便于批量搜索
2. **知识库覆盖度**：转换的Markdown文档可能不包含Flash功能章节
3. **缺少硬件测试**：无法验证实际CLI命令

#### 初步结论
InCabin Demo**很可能**支持Flash配置，但具体实现细节需要：
1. 阅读HTML用户指南（最快）
2. 或进行硬件实测（最准确）

---

## 🔗 相关资源

### 官方文档
| 文档 | 路径 | 状态 |
|------|------|------|
| InCabin用户指南 | `AWRL6844_InCabin_Demos\docs\AWRL6844_InCabin_Demos_User_Guide.html` | 🔴 待阅读 |
| QSPI驱动文档 | `MMWAVE_L_SDK\docs\drivers\qspi\` | 🔴 待查找 |
| Flash编程指南 | TI官网 | 🔴 待搜索 |

### 工具和脚本
- UniFlash：固件和数据烧录
- UART终端：CLI交互（Tera Term、PuTTY）
- InCabin GUI：可视化配置

### 参考示例
- Parking Garage Sensor (xWR68xx) - Flash配置参考
- QSPI Flash示例 (MMWAVE_L_SDK) - 底层操作参考

---

## 📌 待解答问题（更新中）

### 核心问题
1. ❓ InCabin Demo支持哪些Flash CLI命令？
2. ❓ 配置数据存储在Flash的什么位置？
3. ❓ 配置数据的格式和结构是什么？
4. ❓ 是否支持多个配置槽位？
5. ❓ 校准数据如何存储和加载？
6. ❓ UniFlash能否预烧录配置数据？

### 技术细节
7. ❓ Flash的擦除块大小是多少？
8. ❓ 配置数据有CRC校验吗？
9. ❓ 如何处理Flash写入失败？
10. ❓ 配置数据有版本管理吗？

---

## 💡 研究心得

### 发现
1. TI的mmWave雷达固件文档主要以HTML格式提供
2. Flash配置功能不是所有Demo的标准功能
3. 不同型号（xWR68xx vs AWRL6844）的Flash命令可能不同

### 建议
1. **优先阅读HTML文档**：这是最快获取准确信息的方法
2. **硬件实测最可靠**：文档可能有遗漏，实测最准确
3. **参考其他型号**：可以了解Flash功能的通用设计思路

### 注意事项
1. **不要盲目推测**：Flash地址映射错误可能导致数据丢失
2. **文档优先**：所有推测必须经过文档或测试验证
3. **版本差异**：不同SDK版本的实现可能不同

---

## 📞 需要帮助？

如果你有以下资源，请告知：
- [ ] InCabin Demo源码
- [ ] Flash编程详细文档
- [ ] 实际硬件测试结果
- [ ] TI技术支持的回复

---

**研究状态**: 🚧 **文档调查阶段，等待进一步资源**  
**下一步**: 🎯 **阅读HTML用户指南或进行硬件实测**  
**更新时间**: 2025-12-20
