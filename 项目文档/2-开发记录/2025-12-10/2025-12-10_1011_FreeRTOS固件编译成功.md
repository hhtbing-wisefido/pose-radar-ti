# AWRL6844 FreeRTOS å›ºä»¶ç¼–è¯‘æˆåŠŸè®°å½•

**æ—¥æœŸ**: 2025-12-10 10:11  
**çŠ¶æ€**: âœ… ç¼–è¯‘å’Œé“¾æ¥æˆåŠŸ  
**è¾“å‡º**: `build/pose_fall_awrl6844.out` (860 KB)

---

## ğŸ“‹ å®Œæˆçš„å·¥ä½œ

### 1. æºç é€‚é… SDK 6.x + FreeRTOS

#### 1.1 ä¸»å…¥å£æ”¹å†™
- **æ–‡ä»¶**: `firmware/mss/main.c`
- **å˜æ›´**: TI-RTOS (BIOS) â†’ FreeRTOS API
- **å…³é”®ä¿®æ”¹**:
  - `Task_create()` â†’ `xTaskCreate()`
  - `BIOS_start()` â†’ `vTaskStartScheduler()`
  - ç§»é™¤æ‰€æœ‰ `ti/sysbios` å¤´æ–‡ä»¶

#### 1.2 æ•°æ®å¤„ç†æ¨¡å—é€‚é…
- **æ–‡ä»¶**: `firmware/mss/pose_mss.c`
- **DPU API æ›´æ–°**:
  - `DPU_RangeProcHWA`: åˆå§‹åŒ–å’Œé…ç½®ç»“æ„
  - `DPU_CFARProcHWA`: æŒ‡é’ˆæˆå‘˜å¤„ç†ã€è¾“å‡ºåˆ—è¡¨é…ç½®
  - `DPU_TrackerProc`: init å‚æ•°ã€é…ç½®ç»“æ„æˆå‘˜
- **MMWave Control API**:
  - `MMWave_StartCfg` â†’ `MMWave_StrtCfg`
  - `MMWave_start/stop`: 3 å‚æ•°ç‰ˆæœ¬

#### 1.3 å†…å­˜åˆ†é…å®ç°
- **æ–‡ä»¶**: `firmware/mss/gtrack_alloc.c`
- **åŠŸèƒ½**: ä¸º GTRACK åº“æä¾› `gtrack_alloc/gtrack_free`
- **å®ç°**: åŸºäº FreeRTOS `pvPortMalloc/vPortFree`

---

## ğŸ› ï¸ æ„å»ºæµç¨‹

### é˜¶æ®µ 1: SysConfig ç”Ÿæˆé…ç½®æ–‡ä»¶

**å·¥å…·**: `sysconfig_cli.bat`

```bash
C:\ti\ccs2040\ccs\utils\sysconfig_1.26.0\sysconfig_cli.bat \
  -s "C:\ti\MMWAVE_L_SDK_06_01_00_01\.metadata\product.json" \
  -d "XWRL684X" \
  --package "FCCSP" \
  --context "r5fss0-0" \
  --output "firmware\mss\generated" \
  --compiler ticlang \
  "firmware\mss\pose_awrl6844.syscfg"
```

**ç”Ÿæˆçš„æ–‡ä»¶** (7 ä¸ª .c æ–‡ä»¶):
- `ti_drivers_config.c/h` - é©±åŠ¨é…ç½®
- `ti_drivers_open_close.c/h` - é©±åŠ¨åˆå§‹åŒ–
- `ti_board_config.c/h` - æ¿çº§é…ç½®
- `ti_dpl_config.c/h` - DPL é…ç½®
- `ti_pinmux_config.c` - å¼•è„šå¤ç”¨
- `ti_power_clock_config.c` - æ—¶é’Ÿç”µæº

---

### é˜¶æ®µ 2: ç¼–è¯‘æºæ–‡ä»¶

**ç¼–è¯‘å™¨**: `tiarmclang.exe` (TI ARM Clang 4.0.4 LTS)

**ç¼–è¯‘é€‰é¡¹**:
```
-mcpu=cortex-r5
-mfloat-abi=hard
-mfpu=vfpv3-d16
-O2 -g -Wall
-DSOC_XWRL684X -DAWRL6844
```

**ç¼–è¯‘çš„æ–‡ä»¶** (11 ä¸ª):
1. `pose_model_wrapper.o` - AI æ¨¡å‹å°è£…
2. `main.o` - FreeRTOS ä¸»å…¥å£
3. `pose_mss.o` - MSS æ•°æ®å¤„ç†
4. `gtrack_alloc.o` - GTRACK å†…å­˜åˆ†é…
5. `ti_drivers_config.o` - é©±åŠ¨é…ç½®
6. `ti_drivers_open_close.o` - é©±åŠ¨åˆå§‹åŒ–
7. `ti_board_config.o` - æ¿çº§é…ç½®
8. `ti_board_open_close.o` - æ¿çº§åˆå§‹åŒ–
9. `ti_dpl_config.o` - DPL é…ç½®
10. `ti_pinmux_config.o` - å¼•è„šé…ç½®
11. `ti_power_clock_config.o` - æ—¶é’Ÿç”µæºé…ç½®

---

### é˜¶æ®µ 3: é“¾æ¥ç”Ÿæˆå›ºä»¶

**é“¾æ¥å™¨**: `tiarmclang.exe`  
**é“¾æ¥è„šæœ¬**: `firmware/mss/linker.cmd` (æ¥è‡ª SDK ç¤ºä¾‹)

**é“¾æ¥çš„åº“** (9 ä¸ª):
```
-lfreertos.xwrL684x.r5f.ti-arm-clang.release.lib
-ldatapath_tracker3d.xwrL684x.r5f.ti-arm-clang.release.lib
-lalg_gtrack3d.xwrL684x.r5f.ti-arm-clang.release.lib
-ldrivers.xwrL684x.r5f.ti-arm-clang.release.lib
-lboard.xwrL684x.r5f.ti-arm-clang.release.lib
-lcontrol.xwrL684x.r5f.ti-arm-clang.release.lib
-lutils.xwrL684x.r5f.ti-arm-clang.release.lib
-lmmwavelink_r5.lib
-lfecss_ram_r5.lib
```

**è¾“å‡º**:
- âœ… `build/pose_fall_awrl6844.out` - 860 KB
- ğŸ”— æ‰€æœ‰ç¬¦å·è§£ææˆåŠŸ

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
project-code/pose-fall-awrl6844/
â”œâ”€â”€ firmware/
â”‚   â”œâ”€â”€ mss/
â”‚   â”‚   â”œâ”€â”€ main.c                    âœ… FreeRTOS ä¸»å…¥å£
â”‚   â”‚   â”œâ”€â”€ pose_mss.c                âœ… SDK 6.x DPU API
â”‚   â”‚   â”œâ”€â”€ gtrack_alloc.c            âœ… å†…å­˜åˆ†é…å®ç°
â”‚   â”‚   â”œâ”€â”€ linker.cmd                âœ… é“¾æ¥è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ pose_awrl6844.syscfg      âœ… SysConfig é…ç½®
â”‚   â”‚   â””â”€â”€ generated/                âœ… SysConfig ç”Ÿæˆæ–‡ä»¶
â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â””â”€â”€ pose_model_wrapper.c      âœ… AI æ¨¡å‹å°è£…
â”‚   â””â”€â”€ common/                       âœ… å…¬å…±å¤´æ–‡ä»¶
â”œâ”€â”€ build/
â”‚   â”œâ”€â”€ *.o                           âœ… 11 ä¸ªç›®æ ‡æ–‡ä»¶
â”‚   â””â”€â”€ pose_fall_awrl6844.out        âœ… å›ºä»¶é•œåƒ (860 KB)
â””â”€â”€ tools/
    â”œâ”€â”€ compile_syscfg.bat            âœ… SysConfig ç¼–è¯‘è„šæœ¬
    â””â”€â”€ link.bat                      âœ… é“¾æ¥è„šæœ¬
```

---

## ğŸ”‘ å…³é”®æŠ€æœ¯ç‚¹

### 1. ä¸¥æ ¼éµå®ˆè§„åˆ™
- âŒ **æœªåˆ›å»ºä»»ä½•æ¡©æ–‡ä»¶**
- âœ… ä½¿ç”¨ SDK çœŸå®çš„ SysConfig ç”Ÿæˆæ–‡ä»¶
- âœ… å®ç°äº† GTRACK è¦æ±‚çš„çœŸå®å†…å­˜åˆ†é…å‡½æ•°
- âœ… æŸ¥æ‰¾å¹¶ä½¿ç”¨ SDK ç¤ºä¾‹çš„é“¾æ¥è„šæœ¬

### 2. SDK 6.x API é€‚é…
- **DPU åˆå§‹åŒ–**: å‚æ•°å’Œè¿”å›å€¼å˜åŒ–
- **é…ç½®ç»“æ„**: æŒ‡é’ˆæˆå‘˜éœ€è¦é™æ€åˆ†é…
- **MMWave API**: å‡½æ•°ç­¾åå’Œå‚æ•°æ•°é‡å˜åŒ–
- **TrackerProc**: é…ç½®ç»“æ„å±‚æ¬¡å˜åŒ–

### 3. FreeRTOS é›†æˆ
- ä½¿ç”¨ SDK æä¾›çš„ FreeRTOS é…ç½®
- æ­£ç¡®çš„ include é¡ºåº: DPL â†’ FreeRTOS â†’ Drivers
- å¹³å°å® `SOC_XWRL684X` å¿…é¡»å®šä¹‰

---

## â­ï¸ ä¸‹ä¸€æ­¥è®¡åˆ’

### 1. å›ºä»¶çƒ§å½•
- ä½¿ç”¨ Uniflash å·¥å…·
- çƒ§å½• `pose_fall_awrl6844.out`
- é…ç½®ä¸²å£ç›‘æ§

### 2. åŠŸèƒ½æµ‹è¯•
- éªŒè¯ mmWave é›·è¾¾å¯åŠ¨
- æ£€æŸ¥ DPU æ•°æ®æµ
- æµ‹è¯• GTRACK è·Ÿè¸ªåŠŸèƒ½
- éªŒè¯ AI æ¨¡å‹æ¨ç†

### 3. è°ƒè¯•ä¼˜åŒ–
- æ·»åŠ  DebugP æ—¥å¿—è¾“å‡º
- æ€§èƒ½åˆ†æå’Œä¼˜åŒ–
- å†…å­˜ä½¿ç”¨ç›‘æ§

---

## ğŸ“Š ç¼–è¯‘ç»Ÿè®¡

| é¡¹ç›® | æ•°é‡ | è¯´æ˜ |
|------|------|------|
| æºæ–‡ä»¶ | 11 ä¸ª | C æºä»£ç  |
| å¤´æ–‡ä»¶ | ~50 ä¸ª | SDK + FreeRTOS + é¡¹ç›® |
| ç›®æ ‡æ–‡ä»¶ | 11 ä¸ª | .o æ–‡ä»¶ |
| åº“æ–‡ä»¶ | 9 ä¸ª | SDK é¢„ç¼–è¯‘åº“ |
| å›ºä»¶å¤§å° | 860 KB | .out é•œåƒ |
| ç¼–è¯‘è­¦å‘Š | ä»… SDK å¤´æ–‡ä»¶è­¦å‘Š | æ— é¡¹ç›®ä»£ç è­¦å‘Š |
| é“¾æ¥é”™è¯¯ | 0 | æ‰€æœ‰ç¬¦å·è§£ææˆåŠŸ |

---

## âœ… æ€»ç»“

æˆåŠŸå®Œæˆ AWRL6844 å›ºä»¶ä» TI-RTOS åˆ° FreeRTOS çš„è¿ç§»ï¼š

1. **âœ… ç¼–è¯‘æˆåŠŸ** - æ‰€æœ‰æºæ–‡ä»¶æ— é”™è¯¯ç¼–è¯‘
2. **âœ… é“¾æ¥æˆåŠŸ** - ç”Ÿæˆå¯æ‰§è¡Œå›ºä»¶é•œåƒ
3. **âœ… éµå®ˆè§„åˆ™** - æ— æ¡©æ–‡ä»¶ï¼Œä½¿ç”¨çœŸå® SDK ä»£ç 
4. **âœ… API é€‚é…** - å®Œæ•´é€‚é… SDK 6.x çš„ DPU å’Œ MMWave API
5. **âœ… å¯çƒ§å½•** - ç”Ÿæˆçš„ .out æ–‡ä»¶å¯ç›´æ¥çƒ§å½•åˆ°ç¡¬ä»¶

**ä¸‹ä¸€æ­¥å¯ä»¥è¿›è¡Œç¡¬ä»¶æµ‹è¯•ï¼** ğŸš€
