# 🎯 AWRL6844 姿态检测项目 - 完美 Next Step 计划

**日期**: 2025-12-11 09:00  
**当前阶段**: Phase 5 完成 → Phase 6 硬件烧录测试

---

## 📊 当前项目状态

### ✅ 已完成工作

| 阶段 | 内容 | 状态 | 产出 |
|------|------|------|------|
| Phase 1-3 | 固件框架移植 | ✅ | pose_mss.c, pose_model_wrapper.c |
| Phase 4 | CNN 分类器集成 | ✅ | TI AI 库集成完成 |
| Phase 5 | FreeRTOS 编译 | ✅ | pose_fall_awrl6844.out (860 KB) |
| Phase 5.1 | Appimage 生成 | ✅ | **pose_fall_awrl6844.appimage (100 KB)** |
| 文档 | SOP 配置说明 | ✅ | 硬件配置指南 |
| DevOps | GitHub 同步 | ✅ | https://github.com/hhtbing-wisefido/pose-radar-ti |

### 📁 关键文件

```
build/
├── pose_fall_awrl6844.out        ✅ 860 KB (ELF 调试文件)
├── pose_fall_awrl6844.appimage   ✅ 100 KB (烧录文件) ⭐
├── pose_fall_awrl6844_r5.rig     ✅ 88 KB  (核心镜像)
└── config/
    └── metaimage_cfg.json        ✅ 元数据配置
```

---

## 🎯 Next Step: Phase 6 硬件烧录与测试

### 📋 总体流程

```
Phase 6.1: 硬件准备与烧录 (预计 2小时)
  ↓
Phase 6.2: 固件验证与日志分析 (预计 3小时)
  ↓
Phase 6.3: 功能测试 (预计 4小时)
  ↓
Phase 6.4: 性能优化 (按需)
```

---

## 🔧 Phase 6.1: 硬件准备与烧录 (预计 2小时)

### Step 1.1: 硬件检查清单 ✋

**必需硬件**：
- [ ] AWRL6844 EVM 开发板
- [ ] Micro USB 数据线（用于 UART/供电）
- [ ] XDS110 调试器（可选，用于 CCS 调试）
- [ ] 电源适配器（5V/12V，视板子要求）

**检查项**：
- [ ] EVM 板供电正常
- [ ] USB 连接到 PC 后识别 COM 口
- [ ] 驱动程序已安装（FTDI/TI USB Serial）

### Step 1.2: 安装 Uniflash ✋

**下载地址**:
```
https://www.ti.com/tool/UNIFLASH
```

**版本要求**: 
- Uniflash 8.x 或更高
- 支持 AWR/IWR 6xxx 系列

**安装验证**:
```bash
# 安装路径示例
C:\ti\uniflash_8.x.x\
```

### Step 1.3: SOP 配置为刷写模式 ✋

**参考文档**: `项目文档/2-开发记录/2025-12-10/2025-12-10_1900_AWRL6844_SOP配置完整说明.md`

**步骤**:
1. **断开 EVM 板电源**
2. **设置 SOP 开关**:
   ```
   S7/S8 = 00  (QSPI 刷写模式 / SOP_MODE1)
   ```
3. **按 nRESET 按钮** - 使配置生效
4. **连接 USB 到 PC**
5. **记录 COM 端口号** (设备管理器中查看)

### Step 1.4: 使用 Uniflash 烧录固件 ⭐

**操作流程**:

1. **启动 Uniflash**
   ```
   C:\ti\uniflash_8.x.x\uniflash.bat
   ```

2. **选择设备**
   - Device: `AWR6843` 或 `AWRL6844` (根据可用选项)
   - Connection: `Serial (UART)`
   - COM Port: 选择识别的端口

3. **加载固件文件**
   ```
   文件路径：
   D:\7.项目资料\Ti雷达项目\project-code\pose-fall-awrl6844\build\pose_fall_awrl6844.appimage
   ```

4. **烧录到 QSPI Flash**
   - Target: `QSPI Flash`
   - Address: `0x00000000`
   - 点击 **Load Image**

5. **等待烧录完成**
   - 进度条 100%
   - 状态显示 "Success"

6. **验证烧录**
   - Uniflash 显示 "Verification Passed"

**预计时间**: 30 秒 - 2 分钟

### Step 1.5: 切换到功能模式 ✋

**步骤**:
1. **断开 EVM 板电源**
2. **设置 SOP 开关**:
   ```
   S7/S8 = 01  (功能模式 / SOP_MODE2)
   ```
3. **按 nRESET 按钮**
4. **重新上电**

---

## 🔍 Phase 6.2: 固件验证与日志分析 (预计 3小时)

### Step 2.1: 串口监控配置

**工具选择** (3选1):

**选项 1: PuTTY** (推荐)
```
下载: https://www.putty.org/
配置:
- Serial line: COM_X (数据端口，通常波特率 921600)
- Speed: 921600
- Connection type: Serial
```

**选项 2: Tera Term**
```
下载: https://tera-term.soft32.com/
配置同 PuTTY
```

**选项 3: Python 监控脚本** ⭐
```bash
cd project-code/pose-fall-awrl6844/tools
python monitor_radar_data.py
```

**COM 端口识别**:
- **CLI 端口**: 115200 (命令行接口)
- **数据端口**: 921600 (雷达数据输出)

### Step 2.2: 启动日志验证

**预期输出** (示例):
```
[MSS] System Init...
[MSS] FreeRTOS Start
[DPU] Range Proc Init: OK
[DPU] CFAR Proc Init: OK
[DPU] Tracker Proc Init: OK
[Model] CNN Classifier Loaded
[MMWave] Config Loaded
[MMWave] Sensor Started
```

**关键检查点**:
- [ ] FreeRTOS 调度器启动
- [ ] DPU 模块初始化成功
- [ ] MMWave 传感器启动
- [ ] CNN 分类器加载
- [ ] 无致命错误（Fatal Error / Assertion Failed）

### Step 2.3: 异常处理

**常见问题**:

| 问题 | 可能原因 | 解决方案 |
|------|---------|---------|
| 无任何输出 | SOP 配置错误 | 检查 SOP=01，按 nRESET |
| 启动循环 | 固件损坏 | 重新烧录 |
| DPU 初始化失败 | 配置错误 | 检查 .syscfg 配置 |
| COM 口无法打开 | 驱动未安装 | 安装 FTDI 驱动 |

---

## ✅ Phase 6.3: 功能测试 (预计 4小时)

### Step 3.1: 雷达数据流验证

**测试项**:
1. **范围处理 (Range Processing)**
   - 检查 Range FFT 输出
   - 验证检测距离范围

2. **CFAR 检测**
   - 确认目标检测
   - 检查检测阈值

3. **追踪器 (Tracker)**
   - 验证目标追踪
   - 检查追踪 ID 分配

**验证方法**:
```bash
# 使用监控脚本
python tools/monitor_radar_data.py

# 预期输出：
数据包 #1 | 大小: 1024 字节 | 累计: 1024 字节
数据包 #2 | 大小: 1024 字节 | 累计: 2048 字节
...
```

### Step 3.2: AI 模型推理测试

**测试场景**:

| 姿态 | 测试方法 | 预期输出 |
|------|---------|---------|
| 站立 (Standing) | 人员站立不动 | Class: 0 (Standing) |
| 坐下 (Sitting) | 人员坐在椅子上 | Class: 1 (Sitting) |
| 躺下 (Lying) | 人员平躺 | Class: 2 (Lying) |
| 跌倒 (Falling) | 模拟跌倒动作 | Class: 3 (Falling) |
| 弯腰 (Bending) | 弯腰动作 | Class: 4 (Bending) |

**验证标准**:
- 分类准确率 > 80%
- 响应时间 < 200ms
- 无误检/漏检

### Step 3.3: 完整工作流测试

**端到端测试**:
```
1. 雷达扫描 (50ms)
   ↓
2. Range FFT (10ms)
   ↓
3. CFAR 检测 (5ms)
   ↓
4. 目标追踪 (20ms)
   ↓
5. 特征提取 (10ms)
   ↓
6. CNN 推理 (30ms)
   ↓
7. 结果输出 (5ms)

总延迟: ~130ms ✅ (目标 <200ms)
```

### Step 3.4: 性能监控

**监控指标**:
- **CPU 使用率**: < 80%
- **内存占用**: < 256 KB
- **帧率**: 10-20 FPS
- **功耗**: 记录实际功耗

**工具**:
- CCS ROV (Runtime Object View) - 如果使用 CCS 连接
- 串口日志中的性能计数器

---

## 📊 Phase 6.4: 数据记录与分析 (可选)

### Step 4.1: 测试数据收集

**记录内容**:
1. 启动日志 (保存为 `.log` 文件)
2. 性能数据 (CSV 格式)
3. 分类结果统计

**数据保存位置**:
```
项目文档/2-开发记录/2025-12-11/
├── 2025-12-11_启动日志.log
├── 2025-12-11_性能数据.csv
└── 2025-12-11_测试报告.md
```

### Step 4.2: 问题记录

**创建测试报告**:
```markdown
# AWRL6844 硬件测试报告

## 测试环境
- 日期: 2025-12-11
- 固件版本: pose_fall_awrl6844.appimage (100KB)
- EVM 版本: AWRL6844

## 测试结果
- [ ] 固件烧录成功
- [ ] 系统启动正常
- [ ] DPU 工作正常
- [ ] AI 推理准确

## 发现的问题
1. ...
2. ...

## 下一步优化
1. ...
```

---

## 🎯 成功标准

**Phase 6 完成标志**:

✅ **硬件验证**:
- [ ] 固件成功烧录到 Flash
- [ ] EVM 板正常启动
- [ ] 串口日志无严重错误

✅ **功能验证**:
- [ ] 雷达数据流正常
- [ ] DPU 处理正常
- [ ] AI 模型推理成功
- [ ] 5 类姿态识别准确

✅ **性能验证**:
- [ ] 帧率 ≥ 10 FPS
- [ ] 延迟 < 200ms
- [ ] CPU 使用率 < 80%

---

## 📚 参考文档

### 已准备的文档
1. **SOP 配置**: `项目文档/2-开发记录/2025-12-10/2025-12-10_1900_AWRL6844_SOP配置完整说明.md`
2. **编译记录**: `项目文档/2-开发记录/2025-12-10/2025-12-10_1011_FreeRTOS固件编译成功.md`
3. **固件格式**: `知识库/原始DEMO固件/固件镜像格式说明.md`

### 知识库资源
- `知识库/AWRL6844EVM-规格书swru630a.md` - EVM 硬件说明
- `知识库/雷达模块/RADAR-TOOLBOX/` - 开发工具文档
- `知识库/Pose_And_Fall_Detection/` - 原始 DEMO 参考

---

## ⏱️ 时间估算

| 阶段 | 预计时间 | 关键步骤 |
|------|---------|---------|
| Phase 6.1 | 2 小时 | 硬件准备、烧录 |
| Phase 6.2 | 3 小时 | 日志验证、调试 |
| Phase 6.3 | 4 小时 | 功能测试 |
| Phase 6.4 | 2 小时 | 数据分析、报告 |
| **总计** | **11 小时** | **分 2-3 天完成** |

---

## 🚀 立即开始

### 现在就可以做的准备工作

1. **检查硬件** ✋
   ```
   - AWRL6844 EVM 是否在手边？
   - USB 线缆是否准备好？
   - PC 驱动是否已安装？
   ```

2. **安装工具** ✋
   ```bash
   # 下载 Uniflash
   https://www.ti.com/tool/UNIFLASH
   
   # 下载 PuTTY (可选)
   https://www.putty.org/
   ```

3. **备份固件** ✋
   ```bash
   # 复制 appimage 到安全位置
   copy build\pose_fall_awrl6844.appimage backup\
   ```

---

## 🎉 最终目标

**完成 Phase 6 后，您将拥有**:

✅ 一个完全功能的 AWRL6844 姿态检测系统  
✅ 在硬件上验证的 AI 模型  
✅ 实测的性能数据  
✅ 完整的测试报告  
✅ 可演示的 Demo  

**然后可以进入**:
- 🎯 Phase 7: 优化和调参
- 🎯 Phase 8: 产品化部署

---

**准备好了吗？让我们开始 Phase 6！** 🚀
