# 🔴 AWRL6844项目紧急重新评估报告

**日期**: 2026-01-07  
**触发原因**: 连续5次配置测试均无法获得点云数据  
**评估类型**: 🚨 Go/No-Go决策点  
**状态**: 🔴 严重问题

---

## 📊 当前项目状态总结

### ✅ 已完成的工作

1. **SDK深度研究** - 完成12个Part的文档
2. **固件编译** - 成功从源码编译InCabin Demo
3. **固件烧录** - 成功烧录到AWRL6844-EVM
4. **配置研究** - 创建5个版本的配置文件（v1.0-v1.5）
5. **工具兼容性分析** - 发现SDK Visualizer与InCabin固件TLV不兼容
6. **参数优化** - 根据TI官方文档调整CFAR参数（K0: 8.0→7.0→5.0）

### ❌ 无法解决的核心问题

**现象**: 所有测试配置均显示 **Detection Points = 0**

| 配置版本 | CFAR K0 | 检测区域 | 工具 | 结果 |
|---------|---------|---------|------|------|
| v1.0-v1.2 | 8.0 | 1.6m×2m | SDK Visualizer | Points = 0 ❌ |
| v1.3 | 8.0 | 1.6m×2m | SDK Visualizer | Points = 0 ❌ |
| v1.4 | 7.0 (TI推荐) | 1.6m×2m | SDK Visualizer | Points = 0 ❌ |
| v1.5 | 5.0 (极低) | 4m×5m | InCabin GUI | **Points = 0 ❌** |
| cpd.cfg (TI官方) | - | - | InCabin GUI | **未知**（用户测试中） |

### 🔍 历史测试结果对比

**唯一成功的测试**：
```
✅ 标准mmwave_demo.release.appimage + 6844_profile_4T4R_tdm.cfg + SDK Visualizer
   → 点云数据正常显示
```

**所有InCabin固件测试**：
```
❌ InCabin固件 + 任何配置 + 任何工具 → Detection Points = 0
```

---

## 🔴 根本问题诊断

### 可能性1: 固件本身有问题 (概率: 40%)

**证据**：
- ✅ 标准Demo固件工作正常
- ❌ InCabin固件（自编译）无法检测
- ❌ InCabin固件（TI预编译）也无法检测（根据用户1.6测试报告）

**可能原因**：
- InCabin Demo固件本身存在bug
- 编译过程中某些关键库未正确链接
- DSP与MSS之间的通信有问题

**验证方法**：
```
使用TI官方预编译的InCabin固件测试:
C:\ti\radar_toolbox_3_30_00_06\source\ti\examples\Automotive_InCabin_Security_and_Safety\AWRL6844_InCabin_Demos\prebuilt_binaries\demo_in_cabin_sensing_6844_system.release.appimage
```

如果官方固件也无法检测 → **InCabin Demo本身可能不适合你的应用场景**

---

### 可能性2: 硬件配置问题 (概率: 30%)

**证据**：
- ✅ 标准Demo工作 → 天线连接正常
- ❌ InCabin无法检测 → 可能某些硬件特性未启用

**InCabin vs 标准Demo硬件需求差异**：

| 特性 | 标准Demo | InCabin Demo | 可能影响 |
|------|---------|--------------|---------|
| **天线相位校准** | 不需要 | 需要精确校准 | 🔴 高 |
| **时钟同步** | 基础 | 严格要求 | ⚠️ 中 |
| **RF增益** | 默认 | 可能需要调整 | ⚠️ 中 |

**compRangeBiasAndRxChanPhase问题**：
当前配置使用默认值：
```cfg
compRangeBiasAndRxChanPhase 0 1 0 1 0 1 0 1 0 -1 0 -1 0 -1 0 -1 0 1 0 1 0 1 0 1 0 -1 0 -1 0 -1 0 -1 0
```

**InCabin可能需要实际校准值**！TI Point Cloud Tuning Guide强调：
> "Applying phase calibration is crucial for CPD mode"

---

### 可能性3: CFAR参数仍然不够激进 (概率: 20%)

**当前最激进参数** (v1.5)：
```cfg
dynamicRACfarCfg ... 5.00 4.00 ...  # K0=5, noise=4
```

**更激进的尝试**：
```cfg
dynamicRACfarCfg ... 3.00 2.00 ...  # K0=3, noise=2（极极低）
```

但从Ground Truth波形有数据来看，特征提取在工作，问题应该不在CFAR层。

---

### 可能性4: InCabin Demo不适合室内应用 (概率: 10%)

**InCabin设计初衷**：
- 车内空间（狭小、封闭）
- 短距离检测（0.5-2m）
- 婴儿检测（弱目标）

**室内养老场景差异**：
- 开放空间（大房间）
- 中等距离（1-6m）
- 成人检测（强目标）

**可能的问题**：
- InCabin的杂波抑制算法过于激进，把正常目标当成杂波过滤掉了
- Zone定义逻辑不适合大空间

---

## 💡 关键技术盲点分析

### 盲点1: 相位校准未执行

**问题**：从头到尾没有执行过天线相位校准

**TI文档明确要求**：
> "Step 1 of Point Cloud Tuning: Perform phase calibration"

**如何校准**：
1. 使用DCA1000采集原始ADC数据
2. 使用mmWave Studio生成校准文件
3. 将校准参数填入`compRangeBiasAndRxChanPhase`

**当前状态**：使用的是默认值，可能导致角度估计错误 → Capon算法失效 → 无点云

---

### 盲点2: Range Profile未检查

**问题**：所有测试都在看"Points Detected"，但从未检查Range Profile

**Range Profile的重要性**：
- **如果Range Profile平坦（无峰值）** → 雷达没收到反射 → 硬件/RF问题
- **如果Range Profile有峰值但Points=0** → CFAR过滤问题 → 参数问题

**当前状态**：
- SDK Visualizer测试中未启用Range Profile显示
- InCabin GUI测试中可能也未注意Range Profile

**必须执行**：
```cfg
guiMonitor 1 1 1 1 0 1 1 1
%          ^ ^
%          | +-- rangeProfile必须启用
%          +---- pointCloud必须启用
```

---

### 盲点3: 调试输出未启用

**问题**：固件内部的调试信息从未启用

**InCabin固件支持的调试输出**：
```c
// mmwave_demo_mss.h line 2000+
MMWDEMO_OUTPUT_DEBUG_CAPON_HEATMAP = 2003,
MMWDEMO_OUTPUT_DEBUG_CAPON_RAW_CFAR_POINT_CLOUD = 2004,
MMWDEMO_OUTPUT_DEBUG_RADAR_CUBE_FRESH_CHUNK = 2007,
```

**如何启用**：需要修改固件源码，重新编译

**价值**：可以看到CFAR原始输出，判断是CFAR问题还是后处理问题

---

## 🎯 建议的后续行动方案

### 方案A: 继续InCabin路线（需要2-3天）⏱️

**前提条件**：
- ✅ 有3天时间深入调试
- ✅ 愿意学习天线校准
- ✅ 有DCA1000数据采集卡（或用mmWave Studio）

**步骤**：
1. **使用TI官方预编译InCabin固件测试**
   - 如果官方固件能检测 → 自编译固件有问题
   - 如果官方固件也不能 → 参数/硬件问题

2. **执行天线相位校准**
   - 使用mmWave Studio校准工具
   - 生成正确的`compRangeBiasAndRxChanPhase`参数
   - 重新测试

3. **启用Range Profile观察**
   - 确认雷达是否真的接收到反射
   - 如果有峰值→调整CFAR
   - 如果无峰值→检查硬件

4. **启用调试输出**
   - 修改固件源码启用CAPON_RAW_CFAR_POINT_CLOUD输出
   - 查看CFAR原始检测结果
   - 定位过滤问题

**预期成功率**：50%

---

### 方案B: 切换到标准Demo（立即可用）✅

**理由**：
- ✅ 标准Demo已验证工作正常
- ✅ SDK Visualizer完全兼容
- ✅ 点云数据稳定输出
- ✅ 不需要复杂的校准

**实现路径**：
1. **使用标准mmwave_demo固件**
   - 文件：`mmwave_demo.release.appimage`
   - 配置：`6844_profile_4T4R_tdm.cfg`
   - 工具：SDK Visualizer

2. **在标准Demo基础上开发**
   - 点云数据 → 人存检测（检测到点=有人）
   - 点云聚类 → 人数统计
   - 点的Z坐标 → 姿态识别（站/坐/躺）
   - Z坐标突变 → 跌倒检测

3. **优势**：
   - ✅ 立即可以开始算法开发
   - ✅ 基础功能可靠
   - ✅ 点云数据稳定
   - ✅ 开发周期短

4. **劣势**：
   - ❌ 无CNN分类器（需自己实现）
   - ❌ 无Occupancy特征（需自己提取）
   - ❌ 需要在PC端处理（固件端不做分类）

**预期成功率**：90%

---

### 方案C: 更换硬件到IWR6843（推荐用于生命体征）🏥

**理由**：
- ✅ TI官方有Vital Signs Demo
- ✅ 支持呼吸+心率检测
- ✅ 适合室内场景
- ✅ 文档完善

**IWR6843 vs AWRL6844对比**：

| 特性 | AWRL6844 (车载) | IWR6843 (工业) | 养老场景适配度 |
|------|----------------|----------------|---------------|
| **Vital Signs** | ❌ 无官方支持 | ✅ 官方Demo | IWR6843更好 ✅ |
| **人存/姿态** | ✅ InCabin Demo | ✅ 标准Demo | 都支持 |
| **价格** | 较贵 | 较便宜 | IWR6843更好 ✅ |
| **开发难度** | 高（缺文档） | 低（文档全） | IWR6843更好 ✅ |

**建议**：
- **如果需要生命体征检测** → IWR6843
- **如果只需人存/姿态/跌倒** → AWRL6844标准Demo也可以

---

## 📋 决策矩阵

| 方案 | 实现难度 | 开发周期 | 成功概率 | 功能完整度 | 推荐度 |
|-----|---------|---------|---------|-----------|--------|
| **A. 继续InCabin** | ⭐⭐⭐⭐⭐ 很难 | 2-3天 | 50% | 🟢🟢🟢🟢🟢 | ⚠️ 高风险 |
| **B. 标准Demo** | ⭐⭐ 简单 | 立即 | 90% | 🟢🟢🟢 | ✅ 推荐 |
| **C. 换IWR6843** | ⭐⭐⭐ 中等 | 需采购硬件 | 95% | 🟢🟢🟢🟢🟢 | ✅ 长期最优 |

---

## 🚨 Go/No-Go建议

### 对于"人存+姿态+跌倒"功能

**建议**: ✅ **Go - 使用标准Demo路线**

**理由**：
1. 标准Demo点云已验证工作
2. 点云数据足够实现基础功能
3. 开发周期可控
4. 风险低

**实施**：
- 立即切换到标准mmwave_demo固件
- 使用6844_profile_4T4R_tdm.cfg
- 在PC端开发点云处理算法

---

### 对于"呼吸+心率"功能

**建议**: ⚠️ **重新评估需求优先级**

**当前现实**：
- AWRL6844无官方Vital Signs支持
- 自研算法难度极高（需2-4周）
- 成功率不确定（<60%）

**建议**：
1. **短期**：先实现人存/姿态/跌倒（使用标准Demo）
2. **中期**：如果必须要呼吸心率，考虑：
   - 选项1: 增加IWR6843模块专门做生命体征
   - 选项2: 使用其他传感器（如睡眠板、PPG）
3. **长期**：研究在AWRL6844上移植Vital Signs算法

---

## 💰 成本效益分析

### 继续调试InCabin的隐性成本

| 成本项 | 估算 |
|--------|------|
| **时间成本** | 2-3天深度调试 |
| **机会成本** | 延误整体项目进度 |
| **失败风险** | 50%可能仍无法解决 |
| **学习成本** | 需要掌握相位校准、Capon算法 |

### 切换到标准Demo的收益

| 收益项 | 价值 |
|--------|------|
| **即时可用** | 立即获得点云数据 ✅ |
| **降低风险** | 90%成功率 ✅ |
| **加速项目** | 可以立即开始算法开发 ✅ |
| **简化维护** | 标准Demo文档完善 ✅ |

---

## 🎯 最终建议

### 短期行动（今天-明天）

1. **最后验证一次**：使用TI官方预编译InCabin固件测试
   - 如果能检测 → 继续InCabin路线
   - 如果不能 → 立即切换标准Demo

2. **切换到标准Demo路线**（如果InCabin确认无法工作）
   - 烧录：`mmwave_demo.release.appimage`
   - 配置：`6844_profile_4T4R_tdm.cfg`
   - 工具：SDK Visualizer
   - **目标**：今天能看到稳定的点云数据

3. **开始算法开发**
   - 基于点云数据实现人存检测
   - 基于点云聚类实现人数统计
   - 基于Z坐标实现姿态识别

---

### 中期规划（1-2周）

1. **完善基础功能**
   - 人存检测准确率 >95%
   - 姿态识别准确率 >85%
   - 跌倒检测准确率 >90%

2. **评估生命体征需求**
   - 与产品经理确认呼吸心率的必要性
   - 如果必须要 → 考虑增加IWR6843模块
   - 如果不必须 → 专注做好人存/姿态/跌倒

---

### 长期考虑（1个月+）

1. **如果必须用AWRL6844做生命体征**
   - 研究从IWR6843移植Vital Signs算法
   - 预计研发周期：4-8周
   - 成功率：60-70%

2. **或者采用双模块方案**
   - AWRL6844：人存/姿态/跌倒
   - IWR6843：呼吸/心率
   - 成本增加，但功能最完整

---

## 📊 决策建议总结

**基于5次失败测试的经验，我的建议是**：

🟢 **立即切换到标准Demo路线**

**理由**：
1. ✅ 已验证可用（6844_profile_4T4R_tdm.cfg工作正常）
2. ✅ 功能足够（人存/姿态/跌倒都能实现）
3. ✅ 风险可控（90%成功率）
4. ✅ 时间可控（立即可用）

**放弃**：
- ❌ InCabin Demo（除非TI官方固件能工作）
- ❌ 短期内实现呼吸心率（移到P2优先级）

**保留**：
- ⏳ 长期研究InCabin/Vital Signs（作为技术储备）

---

## 🔴 紧急决策点

**请回答以下问题，决定下一步**：

1. **TI官方预编译InCabin固件测试了吗？**
   - [ ] 是，能检测 → 继续InCabin
   - [ ] 是，不能检测 → 切换标准Demo
   - [ ] 还没测 → 立即测试

2. **呼吸心率功能是P0必需吗？**
   - [ ] 是 → 考虑IWR6843
   - [ ] 否 → 专注人存/姿态/跌倒

3. **还有多少时间调试？**
   - [ ] <1天 → 立即切换标准Demo
   - [ ] 2-3天 → 可以尝试继续InCabin
   - [ ] 1周+ → 可以深度研究

**根据你的回答，给出最终Go/No-Go决策！**

---

**结论**: 不要在一个不确定能工作的方向上继续浪费时间。**切换到已验证可用的标准Demo，先把基础功能跑起来，再考虑高级功能**。

**项目成功 > 技术完美** 🎯
