# ⚠️ AWRL6844架构错误修正说明

> **修正日期**: 2026-01-07  
> **严重程度**: 🔴 高危 - 核心技术架构理解错误  
> **影响范围**: SDK分析文档、开发方案规划

---

## 🔥 问题发现

在深度分析mmw_demo SDK源码时，初版文档包含严重的技术架构错误：

**错误描述** | **实际情况**
-----------|------------
❌ "AWRL6844只有R5F核心，没有DSP" | ✅ 有R5F + C66x DSP + HWA三核心
❌ "AWRL6844没有MSS/DSS" | ✅ 有APPSS/DSS/FECSS子系统架构
❌ "单核+硬件加速架构" | ✅ 多核心协同架构
❌ "R5F统一控制，无分离编程" | ✅ APPSS/DSS明确分工
❌ "L系列 vs 经典系列的架构区别" | ✅ 编造的分类，官方无此划分

---

## 📚 正确的AWRL6844架构（基于官方文档）

### 数据来源

- `awrl6844规格书.md` (SWRS353B, TI官方数据手册)
- `xWRL68xx Technical Reference Manual.md` (SWRU621, 3243页技术手册)
- `AWRL6844EVM-规格书swru630a.md` (EVM用户手册)

### 真实架构（官方规格书第3-4页）

```
┌──────────────────────────────────────────────────────────┐
│              AWRL6844 四子系统架构                        │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  1. APPSS (Application SubSystem)                        │
│     - ARM Cortex-R5F @ 200MHz                            │
│     - 768KB TCM RAM (512KB TCMA + 256KB TCMB)            │
│     - 256KB ROM                                          │
│     - 外设: CANFD×2, UART×2, SPI×2, I2C, QSPI, LIN       │
│     职责: 主控核心、应用逻辑、汽车接口、FreeRTOS         │
│                                                          │
│  2. DSS (DSP SubSystem)                                  │
│     - TI C66x DSP @ 450MHz                               │
│     - 64KB L1 + 384KB L2 + 512KB L3 RAM (AWRL6844独有)   │
│     - HWA 1.2 @ 200MHz (硬件加速器)                      │
│     职责: 雷达信号处理 (FFT/CFAR/DoA/AoA)                │
│                                                          │
│  3. FECSS (Front End Controller SubSystem)               │
│     - ARM Cortex-M3 @ 100/200MHz                         │
│     职责: RF前端配置、校准、时序控制                      │
│                                                          │
│  4. RFANASS (RF/Analog SubSystem)                        │
│     - 57-64GHz FMCW雷达前端                              │
│     - 4TX/4RX (AWRL6844), 3TX/4RX (AWRL6843)             │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

### 关键技术参数

| 参数 | AWRL6844 | AWRL6843 | 数据来源 |
|------|---------|---------|---------|
| **R5F核心** | 200MHz | 200MHz | 规格书p.2 |
| **C66x DSP** | 450MHz | 450MHz | 规格书p.2 |
| **HWA** | HWA 1.2@200MHz | HWA 1.2@200MHz | 规格书p.2 |
| **M3核心** | 100/200MHz | 100/200MHz | 规格书p.3 |
| **片上RAM** | 2.5MB | 2MB | 规格书p.4 |
| **DSS L3专用** | 512KB | 无 | 规格书表4-1 |
| **DSS L3共享** | 896KB | 896KB | 规格书表4-1 |
| **发射天线** | 4TX | 3TX | 规格书p.6 |

### 存储器架构（官方规格书表4-1）

| 区域 | 容量 | 共享对象 |
|------|------|---------|
| DSS L3 本机RAM | 512KB | 仅DSS专用（AWRL6844独有） |
| DSS L3 共享RAM | 512KB | DSS ↔ APPSS TCMA |
| DSS L3 共享RAM | 256KB | DSS ↔ APPSS TCMB |
| DSS L3 共享RAM | 128KB | DSS ↔ FECSS |
| **总计** | **2.5MB** | AWRL6844片上总RAM |

---

## 🔧 已修正的内容

### 文档修正清单

✅ **修正文件1**: `项目文档/2-开发记录/2026-01-07/2026-01-07_mmw_demo_SDK源码深度分析.md`
- 删除了所有错误架构描述（Lines 50-120）
- 重写"AWRL6844平台架构详解"章节
- 添加官方文档数据来源
- 更新系统架构图
- 修正关键要点总结

✅ **新增文件**: `项目文档/3-固件工具/08-AWRL6844雷达健康检测实现方案/AWRL6844雷达健康检测-附录G-SDK源码架构分析.md`
- 将修正后的SDK分析文档作为正式附录
- 在文档开头添加"重要更正说明"
- 明确标注数据来源

✅ **更新文件**: `项目文档/3-固件工具/08-AWRL6844雷达健康检测实现方案/README.md`
- 添加"附录G-SDK源码架构分析"到文档索引

---

## 🎓 经验教训

### 为什么会犯这个错误？

**根本原因**：
1. 🔴 **没有先读官方规格书** - 凭"经验"推测架构
2. 🔴 **混淆了工程结构与芯片架构** - 看到只有r5fss0-0工程就以为只有R5F核心
3. 🔴 **编造了"L系列"分类** - 官方从未有此划分

**错误推理链**：
```
看到工程目录只有r5fss0-0_freertos
    ↓
错误推测：只有R5F核心
    ↓
编造"L系列单核"架构
    ↓
与"经典系列双核"对比
    ↓
完全错误的架构理解
```

### 正确的分析流程

```
✅ Step 1: 阅读官方规格书 (awrl6844规格书.md)
✅ Step 2: 查看技术手册 (xWRL68xx TRM)
✅ Step 3: 确认功能方框图
✅ Step 4: 理解子系统架构
✅ Step 5: 分析SDK工程结构
✅ Step 6: 结合芯片架构理解代码
```

### 永久规则

**🔴 禁止推测规则（已加入.github/instructions/file-reading.instructions.md）**：

1. ✅ **遇到文件必须read_file** - 不是建议，是命令
2. ✅ **官方文档必须先读** - 不能凭经验推测
3. ✅ **禁止编造分类/术语** - 官方没有的不要造
4. ✅ **数据必须注明来源** - 规格书第X页，手册章节X

---

## 📊 影响评估

### 已影响的文档/代码

| 文件 | 影响 | 状态 |
|------|------|------|
| SDK分析文档 | 🔴 核心架构错误 | ✅ 已修正 |
| 开发方案规划 | 🟡 理解偏差 | ⚠️ 需重新评估 |
| 算法开发计划 | 🟢 无直接影响 | ✅ 无需修改 |

### 需要重新评估的内容

1. ⚠️ **信号处理任务分配**
   - 原理解：R5F调度HWA执行
   - 实际：APPSS主控，DSS/HWA执行信号处理
   
2. ⚠️ **内存使用规划**
   - 原理解：768KB TCM RAM
   - 实际：768KB TCM + 896KB共享RAM + 512KB DSS专用RAM

3. ⚠️ **性能评估**
   - 原理解：R5F@200MHz + HWA
   - 实际：R5F@200MHz + C66x@450MHz + HWA@200MHz

---

## ✅ 验证方法

### 如何验证架构信息正确？

**验证清单**：
- [x] 规格书功能方框图（第3-4页）
- [x] 技术手册目录结构（APPSS/DSS/FECSS章节）
- [x] EVM用户手册硬件描述
- [x] SDK示例工程编译输出（有DSS链接文件吗？）
- [x] 芯片对比表（官方对比文档）

**关键证据**：
```
官方规格书第3页明确说明：
"该器件分为以下四个可切换电源域：
1. 射频/模拟子系统
2. 前端控制器子系统 (FECSS)：包含负责雷达前端配置、控制和校准的处理器
3. 应用子系统 (APPSS)：实现了一个用户可编程的 ARM Cortex-R5F
4. DSP 子系统 (DSS)：集成了 TI 的高性能 C66x DSP，用于处理雷达信号"
```

---

## 🎯 后续行动

### 立即执行
- [x] 修正SDK分析文档中的所有架构错误
- [x] 添加官方数据来源标注
- [x] 将修正后的文档加入正式项目文档
- [x] 创建本修正说明文档

### 需要评估
- [ ] 重新评估基于mmw_demo开发的技术路线
- [ ] 确认DSS/DSP的使用方式（DPC机制）
- [ ] 规划共享RAM的使用策略
- [ ] 评估C66x DSP的算法卸载能力

### 长期改进
- [ ] 建立官方文档优先阅读机制
- [ ] 创建芯片架构对比表（基于官方数据）
- [ ] 完善开发知识库（避免重复错误）

---

## 📚 相关文档

- ✅ [修正后的SDK源码分析](./2026-01-07_mmw_demo_SDK源码深度分析.md)
- ✅ [附录G-SDK源码架构分析](../../3-固件工具/08-AWRL6844雷达健康检测实现方案/AWRL6844雷达健康检测-附录G-SDK源码架构分析.md)
- 📚 [awrl6844规格书.md](../../../知识库/知识库PDF转机器可读文件/awrl6844规格书.md)
- 📚 [xWRL68xx Technical Reference Manual.md](../../../知识库/知识库PDF转机器可读文件/xWRL68xx Technical Reference Manual.md)

---

> 🔴 **重要提醒**：永远不要在未阅读官方文档的情况下推测技术规格！
